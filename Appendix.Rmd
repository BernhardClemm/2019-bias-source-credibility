---
title: |
  |
  | \vspace{1cm}\setstretch{1}An Ocean of Possible Truth: Biased Processing of News on Social Media\vspace{0.5cm}
  | ONLINE APPENDIX
  |
  |
author: |
  | Bernhard Clemm von Hohenberg^[European University Institute, Via dei Roccettini 9, 50014 San Domenico die Fiesole, Italy. Email: bernhard.clemm@eui.eu. Orcid ID: 0000-0002-6976-9745. This appendix is based on a fully reproducible RMarkdown file that contains code to replicate all graphs and analyses. This describes the raw data. Some of the data were post-weighted for analysis in related published commentary. This manuscript is based on a fully reproducible RMarkdown file that can be found at https://github.com/BernhardClemm/paper-ocean-of-truth-git.]
date: |
  |       
  |
  | `r gsub("^0", "", format(Sys.time(), "%d %B, %Y"))`
  |
  |
  |
  |
  |
  |
  |
  |
  |
  |
  |
  |
  |
  |
linestretch: 1.2
colorlinks: true
bibliography: [References.bib]
csl: american-political-science-association.csl
output:
  bookdown::pdf_document2:
    includes:
      in_header: header.tex
    toc: true
    toc_depth: 2
    keep_tex: true
fontsize: [12pt, letterpaper]
link-citations: true
documentclass: article
geometry: "top=0.8in,left=0.85in,right=0.85in, footskip=0.40in"
always_allow_html: yes
suppress-bibliography: true

---

```{r setup, include = FALSE}

# Knitr options
knitr::opts_chunk$set(cache = FALSE,
                      echo = FALSE,
                      concordance = TRUE,
                      fig.pos = 'H',
                      warning = FALSE,
                      message = FALSE)
# Packages
library(dplyr)
library(tidyr)
library(magrittr)
library(psych)
library(ggplot2)
library(stargazer)
library(ggpubr)
library(margins)
library(modmarg)
library(kableExtra)
library(stringr)

# Set locale
Sys.setlocale("LC_ALL", "en_US.UTF-8")

```

```{r data_1, eval = TRUE, include = FALSE}

#### Import ####

data_1 <- read.csv(file = "Data September 2017 Final Raw Anonymous.csv", 
                 stringsAsFactors = FALSE, 
                 encoding = "UTF-8")

#### Filter observations ####

## Who completed, was screened out of, speeded or aborted survey?

table(data_1$Finished) # 418 completes, 107 non-completes
summary(data_1$Q_TotalDuration[data_1$Finished == "True"]) # Median of completes is 654 seconds

# Of the 107 non completes: 
table(data_1$Progress) # 29 screened out (stopped at 3%, which is screening stage) 
table(data_1$Finished[data_1$Q_TotalDuration < 654/3 & data_1$Progress > 3]) # 16 speeders
table(data_1$Finished[data_1$Q_TotalDuration > 654/3 & data_1$Progress > 3]) # 62 aborted survey

## Keep only completes

data_1 %<>% filter(Finished == "True")

#### Recode & clean ####

source("study1_recoding.r") 

```

```{r data_2, eval = TRUE, include = FALSE}

#### Import ####

data_2 <- read.csv(file = "Data March 2019 Final Raw Anonymous.csv", 
                  stringsAsFactors = FALSE, 
                  encoding = "UTF-8")

#### Filter observations ####

### Exclude one observation (aborted survey) without Respondi ID, not deleted after pre-launch
data_2 <- data_2[!is.na(data_2$tic), ]

### Completion

## Who completed, was screened out of, speeded or aborted survey?

data_2 %<>% rename(completion = Q_TerminateFlag)

table(data_2$completion, exclude = NULL)
table(data_2$completion[data_2$completion == "Screened" & data_2$age < 18]) 
table(data_2$debrief_confirm, exclude = NULL)

  # 3168 observations of which
    # 1063 tagged, of which
      # 308 speeder (312 "Screened" minus 4 under 18 years)
      # 4 under 18 years
      # 751 because of full quota
    # 2105 not screened out
  # 2288 observations that confirmed debrief, of which
    # 308 speeder
    # 1980 valid completes, which equals sample target size
  # Difference between 2105 and 1980 are subjects that aborted survey 

## Recode Completion variable

data_2 %<>% mutate(completion = 
                     case_when(completion == "Screened" & QID731_1 < 18 ~ "Under 18",
                               completion == "Screened" ~ "Speeder",
                               is.na(completion) & is.na(QID213) ~ "Aborted",
                               is.na(completion) & !is.na(QID213)  ~ "Complete",
                               TRUE ~ as.character(completion)))

## Drop all non-completes

data_2 %<>% filter(completion == "Complete")

#### Recode & clean ####

source("study2_recoding.r", echo = TRUE)

#### Drop those without at least one account of email/FB/Twitter/Whatsapp

data_2 %<>% filter(account == 1)

```

```{r functions}

source("functions.r", echo = FALSE)

```

\clearpage

# Sample and population statistics

Both studies use a non-probability quota sample. Tables \@ref(tab:table-quota-sex) through \@ref(tab:table-quota-state) show the two samples' distributions on age, gender, education and state of residence in comparison with the population distribution.

```{r table-quota-sex, paged.print=FALSE}

# Data from https://www-genesis.destatis.de for adult population in Germany 

population_sex <- read.csv("sex_quotas.csv")
population_sex %<>% mutate(population_percent = population_percent*100) 

data_sex <- data.frame(
  sex = names(prop.table(table(data_2$sex))),
  data_1_abs = as.numeric(table(data_1$sex)),
  data_1_rel = as.numeric(prop.table(table(data_1$sex))*100),
  data_2_abs = as.numeric(table(data_2$sex)),
  data_2_rel = as.numeric(prop.table(table(data_2$sex))*100))

data_sex %<>% ungroup() %>%
  mutate(sex = case_when(sex == "maennlich" ~ "male",
                         sex == "weiblich" ~ "female"))
  
population_data_sex <- left_join(population_sex, data_sex, by = "sex") %>% 
  mutate_if(is.numeric, round, 2)

colnames(population_data_sex)[1] <- "Sex"
colnames(population_data_sex)[2] <- paste0("Abs.", footnote_marker_alphabet(1))
colnames(population_data_sex)[c(3, 5, 7)] <- "Percent"
colnames(population_data_sex)[c(4, 6)] <- "Abs."

population_sample_table(population_data_sex, 
                        "Sex distribution of population and samples", 
                        "Population statistics refer to the adult population. 2011 census data extrapolated to 2017 by https://www-genesis.destatis.de/", column_width = NULL)

```

```{r table-quota-age, paged.print=FALSE, eval = T}

# Data from https://www-genesis.destatis.de for adult population in Germany 

population_age <- read.csv("age_quotas.csv")
population_age %<>% mutate(population_percent = population_percent*100) 

data_age <- data.frame(
  age = names(prop.table(table(data_1$age_group_census))),
  data_1_abs = as.numeric(table(data_1$age_group_census)),
  data_1_rel = as.numeric(prop.table(table(data_1$age_group_census))*100),
  data_2_abs = as.numeric(table(data_2$age_group)),
  data_2_rel = as.numeric(prop.table(table(data_2$age_group))*100))
  
population_data_age <- left_join(population_age, data_age, by = "age") %>% 
  mutate_if(is.numeric, round, 2)

colnames(population_data_age)[1] <- "Age"
colnames(population_data_age)[2] <- paste0("Abs.", footnote_marker_alphabet(1))
colnames(population_data_age)[c(3, 5, 7)] <- "Percent"
colnames(population_data_age)[c(4, 6)] <- "Abs."

population_sample_table(population_data_age, 
                        "Age distribution of population and samples", 
                        "Population statistics refer to the adult population. 2011 census data extrapolated to 2017 by https://www-genesis.destatis.de/", column_width = NULL)

```

```{r table-quota-education, paged.print=FALSE, eval = T}

population_education <- read.csv("education_quotas.csv")
population_education %<>% mutate(population_percent = population_percent*100) 

data_education <- data.frame(
  education_6 = names(prop.table(table(data_1$education_6))),
  data_1_abs = as.numeric(table(data_1$education_6)),
  data_1_rel = as.numeric(prop.table(table(data_1$education_6))*100),
  data_2_abs = as.numeric(table(data_2$education_6)),
  data_2_rel = as.numeric(prop.table(table(data_2$education_6))*100))

population_data_education <- 
  left_join(population_education, data_education, by = "education_6") %>% 
  mutate_if(is.numeric, round, 2)
population_data_education[6, "population_absolute"] <- 
  population_data_education[5, "population_absolute"]
population_data_education[6, "population_percent"] <- 
  population_data_education[5, "population_percent"]

colnames(population_data_education)[1] <- "Education"
colnames(population_data_education)[2] <- paste0("Abs.", footnote_marker_alphabet(1))
colnames(population_data_education)[c(3, 5, 7)] <- "Percent"
colnames(population_data_education)[c(4, 6)] <- "Abs."

population_sample_table(population_data_education, 
                        "Education distribution of population and samples", 
                        "Population statistics refer to the adult population. 2011 census data extrapolated to 2017 by https://www-genesis.destatis.de/", 
                        column_width = "5.5cm", columns_coll = c(2:3))

```

\newpage

```{r table-quota-state, paged.print=FALSE, eval = T}

# Data from https://www-genesis.destatis.de for adult population in Germany 

population_states <- read.csv("federal_state_quotas.csv")
population_states %<>% rename(federal_state = state)
population_states %<>% mutate(federal_state = case_when(
  federal_state == "Baden-Wuerttemberg" ~ "Baden-Württemberg",
  federal_state == "Thueringen" ~ "Thüringen",
  TRUE ~ as.character(federal_state)))
population_states %<>% mutate(population_percent = population_percent*100) 

data_states <- data.frame(
  federal_state = names(prop.table(table(data_1$federal_state))),
  data_1_abs = as.numeric(table(data_1$federal_state)),
  data_1_rel = as.numeric(prop.table(table(data_1$federal_state))*100),
  data_2_abs = as.numeric(table(data_2$federal_state)),
  data_2_rel = as.numeric(prop.table(table(data_2$federal_state))*100))

population_data_states <- 
  left_join(population_states, data_states, by = "federal_state") %>% 
  mutate_if(is.numeric, round, 2)

colnames(population_data_states)[1] <- "Federal state"
colnames(population_data_states)[2] <- paste0("Abs.", footnote_marker_alphabet(1))
colnames(population_data_states)[c(3, 5, 7)] <- "Percent"
colnames(population_data_states)[c(4, 6)] <- "Abs."

population_sample_table(population_data_states, 
                        "Geographic distribution of population and samples", 
                        "Population statistics refer to the adult population. 2011 census data extrapolated to 2017 by https://www-genesis.destatis.de/", 
                        column_width = "4cm", columns_coll = c(2:3))

```

# Treatment balance

Tables \@ref(tab:table-balance-content) and \@ref(tab:table-balance-source) show balance statistics across the two treatment dimensions analysed, i.e. content and source. Variables include basic sociodemographics and those relevant for interaction hypotheses. As treatments were re-assigned for each topic, four differences are displayed for each variable for Study 1. Note that only on the attitude and media trust variables, content treatment groups are imbalanced (p-values in bold). Since these are both covariates I planned to include in analyses anyway, the imbalance can be ignored [cf. @MutzPemantle2015, p. 201].

\newpage

```{r table-balance-content, eval = T, results="asis"}

balance_content <- data.frame(variable = NA, content0 = NA, content1 = NA, pvalue = NA)

## Sex

balance_content[1, ] <- c("Gender (proportion female)", "", "", "")

balance_content[2, "variable"] <- "Study 1: Welfare state"
balance_content[2, "content0"] <- 
  round(mean(data_1$sex[data_1$topic1_content == 0]), 2)
balance_content[2, "content1"] <- 
  round(mean(data_1$sex[data_1$topic1_content == 1]), 2)
balance_content[2, "pvalue"] <- 
  format(round(t.test(sex ~ topic1_content, data = data_1)[["p.value"]], 2), nsmall = 2)

balance_content[3, "variable"] <- "Study 1: Domestic security"
balance_content[3, "content0"] <- 
  round(mean(data_1$sex[data_1$topic2_content == 0]), 2)
balance_content[3, "content1"] <- 
  round(mean(data_1$sex[data_1$topic2_content == 1]), 2)
balance_content[3, "pvalue"] <- 
  format(round(t.test(sex ~ topic2_content, data = data_1)[["p.value"]], 2), nsmall = 2)

balance_content[4, "variable"] <- "Study 1: Migration"
balance_content[4, "content0"] <- 
  round(mean(data_1$sex[data_1$topic3_content == 0]), 2)
balance_content[4, "content1"] <- 
  round(mean(data_1$sex[data_1$topic3_content == 1]), 2)
balance_content[4, "pvalue"] <- 
  format(round(t.test(sex ~ topic3_content, data = data_1)[["p.value"]], 2), nsmall = 2)

balance_content[5, "variable"] <- "Study 1: European integration"
balance_content[5, "content0"] <- 
  round(mean(data_1$sex[data_1$topic4_content == 0]), 2)
balance_content[5, "content1"] <- 
  round(mean(data_1$sex[data_1$topic4_content == 1]), 2)
balance_content[5, "pvalue"] <- 
  format(round(t.test(sex ~ topic4_content, data = data_1)[["p.value"]], 2), nsmall = 2)

balance_content[6, "variable"] <- "Study 2"
balance_content[6, "content0"] <- 
  round(mean(data_2$gender[data_2$treatment_content == 0]), 2)
balance_content[6, "content1"] <- 
  round(mean(data_2$gender[data_2$treatment_content == 1]), 2)
balance_content[6, "pvalue"] <- 
  format(round(t.test(gender ~ treatment_content, data = data_2)[["p.value"]], 2), nsmall = 2)

## Age

balance_content[7, ] <- c("Age (mean)", "", "", "")

balance_content[8, "variable"] <- "Study 1: Welfare state"
balance_content[8, "content0"] <- 
  round(mean(data_1$age[data_1$topic1_content == 0]), 2)
balance_content[8, "content1"] <- 
  round(mean(data_1$age[data_1$topic1_content == 1]), 2)
balance_content[8, "pvalue"] <- 
  format(round(t.test(age ~ topic1_content, data = data_1)[["p.value"]], 2), nsmall = 2)

balance_content[9, "variable"] <- "Study 1: Domestic security"
balance_content[9, "content0"] <- 
  round(mean(data_1$age[data_1$topic2_content == 0]), 2)
balance_content[9, "content1"] <- 
  round(mean(data_1$age[data_1$topic2_content == 1]), 2)
balance_content[9, "pvalue"] <- 
  format(round(t.test(age ~ topic2_content, data = data_1)[["p.value"]], 2), nsmall = 2)

balance_content[10, "variable"] <- "Study 1: Migration"
balance_content[10, "content0"] <- 
  round(mean(data_1$age[data_1$topic3_content == 0]), 2)
balance_content[10, "content1"] <- 
  round(mean(data_1$age[data_1$topic3_content == 1]), 2)
balance_content[10, "pvalue"] <- 
  format(round(t.test(age ~ topic3_content, data = data_1)[["p.value"]], 2), nsmall = 2)

balance_content[11, "variable"] <- "Study 1: European integration"
balance_content[11, "content0"] <- 
  round(mean(data_1$age[data_1$topic4_content == 0]), 2)
balance_content[11, "content1"] <- 
  round(mean(data_1$age[data_1$topic4_content == 1]), 2)
balance_content[11, "pvalue"] <- 
  format(round(t.test(age ~ topic4_content, data = data_1)[["p.value"]], 2), nsmall = 2)

balance_content[12, "variable"] <- "Study 2"
balance_content[12, "content0"] <- 
  round(mean(data_2$age[data_2$treatment_content == 0]), 2)
balance_content[12, "content1"] <- 
  round(mean(data_2$age[data_2$treatment_content == 1]), 2)
balance_content[12, "pvalue"] <- 
  format(round(t.test(age ~ treatment_content, data = data_2)[["p.value"]], 2), nsmall = 2)

## Education

balance_content[13, ] <- c("Education (proportion Middle School)", "", "", "")

balance_content[14, "variable"] <- "Study 1: Welfare state"
balance_content[14, "content0"] <- 
  round(prop.table(table(data_1$education[data_1$topic1_content == 0]))[3], 2)
balance_content[14, "content1"] <- 
  round(prop.table(table(data_1$education[data_1$topic1_content == 1]))[3], 2)
balance_content[14, "pvalue"] <- 
  format(round(chisq.test(table(data_1$education[data_1$topic1_content == 0]),
                          table(data_1$education[data_1$topic1_content == 1]))
               [["p.value"]], 2), nsmall = 2)

balance_content[15, "variable"] <- "Study 1: Domestic security"
balance_content[15, "content0"] <- 
  round(prop.table(table(data_1$education[data_1$topic2_content == 0]))[3], 2)
balance_content[15, "content1"] <- 
  round(prop.table(table(data_1$education[data_1$topic2_content == 1]))[3], 2)
balance_content[15, "pvalue"] <- 
  format(round(chisq.test(table(data_1$education[data_1$topic2_content == 0]),
                          table(data_1$education[data_1$topic2_content == 1]))
               [["p.value"]], 2), nsmall = 2)

balance_content[16, "variable"] <- "Study 1: Migration"
balance_content[16, "content0"] <- 
  round(prop.table(table(data_1$education[data_1$topic3_content == 0]))[3], 2)
balance_content[16, "content1"] <- 
  round(prop.table(table(data_1$education[data_1$topic3_content == 1]))[3], 2)
balance_content[16, "pvalue"] <- 
  format(round(chisq.test(table(data_1$education[data_1$topic3_content == 0]),
                          table(data_1$education[data_1$topic3_content == 1]))
               [["p.value"]], 2), nsmall = 2)

balance_content[17, "variable"] <- "Study 1: European integration"
balance_content[17, "content0"] <- 
  round(prop.table(table(data_1$education[data_1$topic4_content == 0]))[3], 2)
balance_content[17, "content1"] <- 
  round(prop.table(table(data_1$education[data_1$topic4_content == 1]))[3], 2)
balance_content[17, "pvalue"] <- 
  format(round(chisq.test(table(data_1$education[data_1$topic4_content == 0]),
                          table(data_1$education[data_1$topic4_content == 1]))
               [["p.value"]], 2), nsmall = 2)

balance_content[18, "variable"] <- "Study 2"
balance_content[18, "content0"] <- 
  round(prop.table(table(data_2$education[data_2$treatment_content == 0]))[3], 2)
balance_content[18, "content1"] <- 
  round(prop.table(table(data_2$education[data_2$treatment_content == 1]))[3], 2)
balance_content[18, "pvalue"] <- 
  format(round(chisq.test(table(data_2$education[data_2$treatment_content == 0]),
                          table(data_2$education[data_2$treatment_content == 1]))
               [["p.value"]], 2), nsmall = 2)

## East vs. West

balance_content[19, ] <- c("West Germany resident (proportion)", "", "", "")

balance_content[20, "variable"] <- "Study 1: Welfare state"
balance_content[20, "content0"] <-
  round(mean(data_1$federal_state_west[data_1$topic1_content == 0], na.rm = T), 2)
balance_content[20, "content1"] <-
  round(mean(data_1$federal_state_west[data_1$topic1_content == 1], na.rm = T), 2)
balance_content[20, "pvalue"] <-
  format(round(t.test(federal_state_west ~ topic1_content, data = data_1)[["p.value"]], 2), nsmall = 2)

balance_content[21, "variable"] <- "Study 1: Domestic security"
balance_content[21, "content0"] <-
  round(mean(data_1$federal_state_west[data_1$topic2_content == 0], na.rm = T), 2)
balance_content[21, "content1"] <-
  round(mean(data_1$federal_state_west[data_1$topic2_content == 1], na.rm = T), 2)
balance_content[21, "pvalue"] <-
  format(round(t.test(federal_state_west ~ topic2_content, data = data_1)[["p.value"]], 2), nsmall = 2)

balance_content[22, "variable"] <- "Study 1: Migration"
balance_content[22, "content0"] <-
  round(mean(data_1$federal_state_west[data_1$topic3_content == 0], na.rm = T), 2)
balance_content[22, "content1"] <-
  round(mean(data_1$federal_state_west[data_1$topic3_content == 1], na.rm = T), 2)
balance_content[22, "pvalue"] <-
  format(round(t.test(federal_state_west ~ topic3_content, data = data_1)[["p.value"]], 2), nsmall = 2)

balance_content[23, "variable"] <- "Study 1: European integration"
balance_content[23, "content0"] <-
  round(mean(data_1$federal_state_west[data_1$topic4_content == 0], na.rm = T), 2)
balance_content[23, "content1"] <-
  round(mean(data_1$federal_state_west[data_1$topic4_content == 1], na.rm = T), 2)
balance_content[23, "pvalue"] <-
  format(round(t.test(federal_state_west ~ topic4_content, data = data_1)[["p.value"]], 2), nsmall = 2)

balance_content[24, "variable"] <- "Study 2"
balance_content[24, "content0"] <-
  round(mean(data_2$federal_state_west[data_2$treatment_content == 0], na.rm = T), 2)
balance_content[24, "content1"] <-
  round(mean(data_2$federal_state_west[data_2$treatment_content == 1], na.rm = T), 2)
balance_content[24, "pvalue"] <-
  format(round(t.test(federal_state_west ~ treatment_content, data = data_2)[["p.value"]], 2), nsmall = 2)

## Media trust

balance_content[25, ] <- c("Media trust index (mean)", "", "", "")

balance_content[26, "variable"] <- "Study 1: Welfare state"
balance_content[26, "content0"] <-
  round(mean(data_1$trustsource_mainstream[data_1$topic1_content == 0], na.rm = T), 2)
balance_content[26, "content1"] <-
  round(mean(data_1$trustsource_mainstream[data_1$topic1_content == 1], na.rm = T), 2)
balance_content[26, "pvalue"] <-
  format(round(t.test(trustsource_mainstream ~ topic1_content, data = data_1)[["p.value"]], 2), nsmall = 2)

balance_content[27, "variable"] <- "Study 1: Domestic security"
balance_content[27, "content0"] <-
  round(mean(data_1$trustsource_mainstream[data_1$topic2_content == 0], na.rm = T), 2)
balance_content[27, "content1"] <-
  round(mean(data_1$trustsource_mainstream[data_1$topic2_content == 1], na.rm = T), 2)
balance_content[27, "pvalue"] <-
  format(round(t.test(trustsource_mainstream ~ topic2_content, data = data_1)[["p.value"]], 2), nsmall = 2)

balance_content[28, "variable"] <- "Study 1: Migration"
balance_content[28, "content0"] <-
  round(mean(data_1$trustsource_mainstream[data_1$topic3_content == 0], na.rm = T), 2)
balance_content[28, "content1"] <-
  round(mean(data_1$trustsource_mainstream[data_1$topic3_content == 1], na.rm = T), 2)
balance_content[28, "pvalue"] <-
  format(round(t.test(trustsource_mainstream ~ topic3_content, data = data_1)[["p.value"]], 2), nsmall = 2)

balance_content[29, "variable"] <- "Study 1: European integration"
balance_content[29, "content0"] <-
  round(mean(data_1$trustsource_mainstream[data_1$topic4_content == 0], na.rm = T), 2)
balance_content[29, "content1"] <-
  round(mean(data_1$trustsource_mainstream[data_1$topic4_content == 1], na.rm = T), 2)
balance_content[29, "pvalue"] <-
  format(round(t.test(trustsource_mainstream ~ topic4_content, data = data_1)[["p.value"]], 2), nsmall = 2)

balance_content[30, "variable"] <- "Study 2"
balance_content[30, "content0"] <-
  round(mean(data_2$trustsource_mainstream[data_2$treatment_content == 0], na.rm = T), 2)
balance_content[30, "content1"] <-
  round(mean(data_2$trustsource_mainstream[data_2$treatment_content == 1], na.rm = T), 2)
balance_content[30, "pvalue"] <-
  format(round(t.test(trustsource_mainstream ~ treatment_content, data = data_2)[["p.value"]], 2), nsmall = 2)

## Attitudes

balance_content[31, ] <- c("Attitude items/indices (mean)", "", "", "")

balance_content[32, "variable"] <- "Study 1: Welfare state"
balance_content[32, "content0"] <-
  round(mean(data_1$topic1_attitude2_stand[data_1$topic1_content == 0], na.rm = T), 2)
balance_content[32, "content1"] <-
  round(mean(data_1$topic1_attitude2_stand[data_1$topic1_content == 1], na.rm = T), 2)
balance_content[32, "pvalue"] <-
  format(round(t.test(topic1_attitude2_stand ~ topic1_content, data = data_1)[["p.value"]], 2), nsmall = 2)

balance_content[33, "variable"] <- "Study 1: Domestic security"
balance_content[33, "content0"] <-
  round(mean(data_1$topic2_attitudes_factor[data_1$topic2_content == 0], na.rm = T), 2)
balance_content[33, "content1"] <-
  round(mean(data_1$topic2_attitudes_factor[data_1$topic2_content == 1], na.rm = T), 2)
balance_content[33, "pvalue"] <-
  format(round(t.test(topic2_attitudes_factor ~ topic2_content, data = data_1)[["p.value"]], 2), nsmall = 2)

balance_content[34, "variable"] <- "Study 1: Migration"
balance_content[34, "content0"] <-
  round(mean(data_1$topic3_attitudes_factor[data_1$topic3_content == 0], na.rm = T), 2)
balance_content[34, "content1"] <-
  round(mean(data_1$topic3_attitudes_factor[data_1$topic3_content == 1], na.rm = T), 2)
balance_content[34, "pvalue"] <-
  format(round(t.test(topic3_attitudes_factor ~ topic3_content, data = data_1)[["p.value"]], 2), nsmall = 2)

balance_content[35, "variable"] <- "Study 1: European integration"
balance_content[35, "content0"] <-
  round(mean(data_1$topic4_attitudes_factor[data_1$topic4_content == 0], na.rm = T), 2)
balance_content[35, "content1"] <-
  round(mean(data_1$topic4_attitudes_factor[data_1$topic4_content == 1], na.rm = T), 2)
balance_content[35, "pvalue"] <-
  format(round(t.test(topic4_attitudes_factor ~ topic4_content, data = data_1)[["p.value"]], 2), nsmall = 2)

balance_content[36, "variable"] <- "Study 2"
balance_content[36, "content0"] <-
  round(mean(data_2$immigrant_attitudes_factor[data_2$treatment_content == 0], na.rm = T), 2)
balance_content[36, "content1"] <-
  round(mean(data_2$immigrant_attitudes_factor[data_2$treatment_content == 1], na.rm = T), 2)
balance_content[36, "pvalue"] <-
  format(round(t.test(immigrant_attitudes_factor ~ treatment_content, data = data_2)[["p.value"]], 2), nsmall = 2)


### Table

balance_content %<>% 
  mutate(variable = 
           cell_spec(variable, "latex", 
                     italic = ifelse(variable == "Study 1: Welfare state" |
                                       variable == "Study 1: Domestic security" |
                                       variable == "Study 1: Migration" |
                                       variable == "Study 1: European integration" |
                                       variable == "Study 2", T, F))) %>%
  mutate(pvalue =
           cell_spec(pvalue, "latex", bold = ifelse(pvalue < 0.05, T, F)))

colnames(balance_content)[1] <- "Variable"
colnames(balance_content)[2] <- "Left-wing congruent"
colnames(balance_content)[3] <- "Right-wing congruent"
colnames(balance_content)[4] <- paste0("Significance", footnote_marker_alphabet(1))

balance_content[13, 1] <- paste0(balance_content[13, 1], "\\textsuperscript{b}")

kable(balance_content, 
      caption = "Balance statistics for content treatment", 
      format = "latex", booktabs = T, linesep = "", longtable = T, escape = F) %>%
  kable_styling(full_width = T,
                latex_options = c("scale_down", "HOLD_position"),
                font_size = 10) %>%
  column_spec(1, width = "6cm") %>%
  column_spec(4, width = "2cm") %>%
  add_indent(c(2:6, 8:12, 14:18, 20:24, 26:30, 32:36)) %>%
  footnote(alphabet = c("p-value of t-test for proportions and means; p-value of chi2-test for categorical variables. Differences significant at 5%-level in bold.", "Only one category of education variable displayed. Significance test refers to all categories."), threeparttable = T)

``` 

```{r table-balance-source, eval = T, results="asis"}

balance_source <- data.frame(variable = NA, source0 = NA, source1 = NA, pvalue = NA)

## Sex

balance_source[1, ] <- c("Gender (proportion female)", "", "", "")

balance_source[2, "variable"] <- "Study 1: Welfare state"
balance_source[2, "source0"] <- 
  round(mean(data_1$sex[data_1$topic1_source == 0]), 2)
balance_source[2, "source1"] <- 
  round(mean(data_1$sex[data_1$topic1_source == 1]), 2)
balance_source[2, "pvalue"] <- 
  format(round(t.test(sex ~ topic1_source, data = data_1)[["p.value"]], 2), nsmall = 2)

balance_source[3, "variable"] <- "Study 1: Domestic security"
balance_source[3, "source0"] <- 
  round(mean(data_1$sex[data_1$topic2_source == 0]), 2)
balance_source[3, "source1"] <- 
  round(mean(data_1$sex[data_1$topic2_source == 1]), 2)
balance_source[3, "pvalue"] <- 
  format(round(t.test(sex ~ topic2_source, data = data_1)[["p.value"]], 2), nsmall = 2)

balance_source[4, "variable"] <- "Study 1: Migration"
balance_source[4, "source0"] <- 
  round(mean(data_1$sex[data_1$topic3_source == 0]), 2)
balance_source[4, "source1"] <- 
  round(mean(data_1$sex[data_1$topic3_source == 1]), 2)
balance_source[4, "pvalue"] <- 
  format(round(t.test(sex ~ topic3_source, data = data_1)[["p.value"]], 2), nsmall = 2)

balance_source[5, "variable"] <- "Study 1: European integration"
balance_source[5, "source0"] <- 
  round(mean(data_1$sex[data_1$topic4_source == 0]), 2)
balance_source[5, "source1"] <- 
  round(mean(data_1$sex[data_1$topic4_source == 1]), 2)
balance_source[5, "pvalue"] <- 
  format(round(t.test(sex ~ topic4_source, data = data_1)[["p.value"]], 2), nsmall = 2)

balance_source[6, "variable"] <- "Study 2"
balance_source[6, "source0"] <- 
  round(mean(data_2$gender[data_2$treatment_source == 0]), 2)
balance_source[6, "source1"] <- 
  round(mean(data_2$gender[data_2$treatment_source == 1]), 2)
balance_source[6, "pvalue"] <- 
  format(round(t.test(gender ~ treatment_source, data = data_2)[["p.value"]], 2), nsmall = 2)

## Age

balance_source[7, ] <- c("Age (mean)", "", "", "")

balance_source[8, "variable"] <- "Study 1: Welfare state"
balance_source[8, "source0"] <- 
  round(mean(data_1$age[data_1$topic1_source == 0]), 2)
balance_source[8, "source1"] <- 
  round(mean(data_1$age[data_1$topic1_source == 1]), 2)
balance_source[8, "pvalue"] <- 
  format(round(t.test(age ~ topic1_source, data = data_1)[["p.value"]], 2), nsmall = 2)

balance_source[9, "variable"] <- "Study 1: Domestic security"
balance_source[9, "source0"] <- 
  round(mean(data_1$age[data_1$topic2_source == 0]), 2)
balance_source[9, "source1"] <- 
  round(mean(data_1$age[data_1$topic2_source == 1]), 2)
balance_source[9, "pvalue"] <- 
  format(round(t.test(age ~ topic2_source, data = data_1)[["p.value"]], 2), nsmall = 2)

balance_source[10, "variable"] <- "Study 1: Migration"
balance_source[10, "source0"] <- 
  round(mean(data_1$age[data_1$topic3_source == 0]), 2)
balance_source[10, "source1"] <- 
  round(mean(data_1$age[data_1$topic3_source == 1]), 2)
balance_source[10, "pvalue"] <- 
  format(round(t.test(age ~ topic3_source, data = data_1)[["p.value"]], 2), nsmall = 2)

balance_source[11, "variable"] <- "Study 1: European integration"
balance_source[11, "source0"] <- 
  round(mean(data_1$age[data_1$topic4_source == 0]), 2)
balance_source[11, "source1"] <- 
  round(mean(data_1$age[data_1$topic4_source == 1]), 2)
balance_source[11, "pvalue"] <- 
  format(round(t.test(age ~ topic4_source, data = data_1)[["p.value"]], 2), nsmall = 2)

balance_source[12, "variable"] <- "Study 2"
balance_source[12, "source0"] <- 
  round(mean(data_2$age[data_2$treatment_source == 0]), 2)
balance_source[12, "source1"] <- 
  round(mean(data_2$age[data_2$treatment_source == 1]), 2)
balance_source[12, "pvalue"] <- 
  format(round(t.test(age ~ treatment_source, data = data_2)[["p.value"]], 2), nsmall = 2)

## Education

balance_source[13, ] <- c("Education (proportion Middle School)", "", "", "")

balance_source[14, "variable"] <- "Study 1: Welfare state"
balance_source[14, "source0"] <- 
  round(prop.table(table(data_1$education[data_1$topic1_source == 0]))[3], 2)
balance_source[14, "source1"] <- 
  round(prop.table(table(data_1$education[data_1$topic1_source == 1]))[3], 2)
balance_source[14, "pvalue"] <- 
  format(round(chisq.test(table(data_1$education[data_1$topic1_source == 0]),
                          table(data_1$education[data_1$topic1_source == 1]))
               [["p.value"]], 2), nsmall = 2)

balance_source[15, "variable"] <- "Study 1: Domestic security"
balance_source[15, "source0"] <- 
  round(prop.table(table(data_1$education[data_1$topic2_source == 0]))[3], 2)
balance_source[15, "source1"] <- 
  round(prop.table(table(data_1$education[data_1$topic2_source == 1]))[3], 2)
balance_source[15, "pvalue"] <- 
  format(round(chisq.test(table(data_1$education[data_1$topic2_source == 0]),
                          table(data_1$education[data_1$topic2_source == 1]))
               [["p.value"]], 2), nsmall = 2)

balance_source[16, "variable"] <- "Study 1: Migration"
balance_source[16, "source0"] <- 
  round(prop.table(table(data_1$education[data_1$topic3_source == 0]))[3], 2)
balance_source[16, "source1"] <- 
  round(prop.table(table(data_1$education[data_1$topic3_source == 1]))[3], 2)
balance_source[16, "pvalue"] <- 
  format(round(chisq.test(table(data_1$education[data_1$topic3_source == 0]),
                          table(data_1$education[data_1$topic3_source == 1]))
               [["p.value"]], 2), nsmall = 2)

balance_source[17, "variable"] <- "Study 1: European integration"
balance_source[17, "source0"] <- 
  round(prop.table(table(data_1$education[data_1$topic4_source == 0]))[3], 2)
balance_source[17, "source1"] <- 
  round(prop.table(table(data_1$education[data_1$topic4_source == 1]))[3], 2)
balance_source[17, "pvalue"] <- 
  format(round(chisq.test(table(data_1$education[data_1$topic4_source == 0]),
                          table(data_1$education[data_1$topic4_source == 1]))
               [["p.value"]], 2), nsmall = 2)

balance_source[18, "variable"] <- "Study 2"
balance_source[18, "source0"] <- 
  round(prop.table(table(data_2$education[data_2$treatment_source == 0]))[3], 2)
balance_source[18, "source1"] <- 
  round(prop.table(table(data_2$education[data_2$treatment_source == 1]))[3], 2)
balance_source[18, "pvalue"] <- 
  format(round(chisq.test(table(data_2$education[data_2$treatment_source == 0]),
                          table(data_2$education[data_2$treatment_source == 1]))
               [["p.value"]], 2), nsmall = 2)

## East vs. West

balance_source[19, ] <- c("West Germany resident (proportion)", "", "", "")

balance_source[20, "variable"] <- "Study 1: Welfare state"
balance_source[20, "source0"] <-
  round(mean(data_1$federal_state_west[data_1$topic1_source == 0], na.rm = T), 2)
balance_source[20, "source1"] <-
  round(mean(data_1$federal_state_west[data_1$topic1_source == 1], na.rm = T), 2)
balance_source[20, "pvalue"] <-
  format(round(t.test(federal_state_west ~ topic1_source, data = data_1)[["p.value"]], 2), nsmall = 2)

balance_source[21, "variable"] <- "Study 1: Domestic security"
balance_source[21, "source0"] <-
  round(mean(data_1$federal_state_west[data_1$topic2_source == 0], na.rm = T), 2)
balance_source[21, "source1"] <-
  round(mean(data_1$federal_state_west[data_1$topic2_source == 1], na.rm = T), 2)
balance_source[21, "pvalue"] <-
  format(round(t.test(federal_state_west ~ topic2_source, data = data_1)[["p.value"]], 2), nsmall = 2)

balance_source[22, "variable"] <- "Study 1: Migration"
balance_source[22, "source0"] <-
  round(mean(data_1$federal_state_west[data_1$topic3_source == 0], na.rm = T), 2)
balance_source[22, "source1"] <-
  round(mean(data_1$federal_state_west[data_1$topic3_source == 1], na.rm = T), 2)
balance_source[22, "pvalue"] <-
  format(round(t.test(federal_state_west ~ topic3_source, data = data_1)[["p.value"]], 2), nsmall = 2)

balance_source[23, "variable"] <- "Study 1: European integration"
balance_source[23, "source0"] <-
  round(mean(data_1$federal_state_west[data_1$topic4_source == 0], na.rm = T), 2)
balance_source[23, "source1"] <-
  round(mean(data_1$federal_state_west[data_1$topic4_source == 1], na.rm = T), 2)
balance_source[23, "pvalue"] <-
  format(round(t.test(federal_state_west ~ topic4_source, data = data_1)[["p.value"]], 2), nsmall = 2)

balance_source[24, "variable"] <- "Study 2"
balance_source[24, "source0"] <-
  round(mean(data_2$federal_state_west[data_2$treatment_source == 0], na.rm = T), 2)
balance_source[24, "source1"] <-
  round(mean(data_2$federal_state_west[data_2$treatment_source == 1], na.rm = T), 2)
balance_source[24, "pvalue"] <-
  format(round(t.test(federal_state_west ~ treatment_source, data = data_2)[["p.value"]], 2), nsmall = 2)

## Media trust

balance_source[25, ] <- c("Media trust index (mean)", "", "", "")

balance_source[26, "variable"] <- "Study 1: Welfare state"
balance_source[26, "source0"] <-
  round(mean(data_1$trustsource_mainstream[data_1$topic1_source == 0], na.rm = T), 2)
balance_source[26, "source1"] <-
  round(mean(data_1$trustsource_mainstream[data_1$topic1_source == 1], na.rm = T), 2)
balance_source[26, "pvalue"] <-
  format(round(t.test(trustsource_mainstream ~ topic1_source, data = data_1)[["p.value"]], 2), nsmall = 2)

balance_source[27, "variable"] <- "Study 1: Domestic security"
balance_source[27, "source0"] <-
  round(mean(data_1$trustsource_mainstream[data_1$topic2_source == 0], na.rm = T), 2)
balance_source[27, "source1"] <-
  round(mean(data_1$trustsource_mainstream[data_1$topic2_source == 1], na.rm = T), 2)
balance_source[27, "pvalue"] <-
  format(round(t.test(trustsource_mainstream ~ topic2_source, data = data_1)[["p.value"]], 2), nsmall = 2)

balance_source[28, "variable"] <- "Study 1: Migration"
balance_source[28, "source0"] <-
  round(mean(data_1$trustsource_mainstream[data_1$topic3_source == 0], na.rm = T), 2)
balance_source[28, "source1"] <-
  round(mean(data_1$trustsource_mainstream[data_1$topic3_source == 1], na.rm = T), 2)
balance_source[28, "pvalue"] <-
  format(round(t.test(trustsource_mainstream ~ topic3_source, data = data_1)[["p.value"]], 2), nsmall = 2)

balance_source[29, "variable"] <- "Study 1: European integration"
balance_source[29, "source0"] <-
  round(mean(data_1$trustsource_mainstream[data_1$topic4_source == 0], na.rm = T), 2)
balance_source[29, "source1"] <-
  round(mean(data_1$trustsource_mainstream[data_1$topic4_source == 1], na.rm = T), 2)
balance_source[29, "pvalue"] <-
  format(round(t.test(trustsource_mainstream ~ topic4_source, data = data_1)[["p.value"]], 2), nsmall = 2)

balance_source[30, "variable"] <- "Study 2"
balance_source[30, "source0"] <-
  round(mean(data_2$trustsource_mainstream[data_2$treatment_source == 0], na.rm = T), 2)
balance_source[30, "source1"] <-
  round(mean(data_2$trustsource_mainstream[data_2$treatment_source == 1], na.rm = T), 2)
balance_source[30, "pvalue"] <-
  format(round(t.test(trustsource_mainstream ~ treatment_source, data = data_2)[["p.value"]], 2), nsmall = 2)

## Attitudes

balance_source[31, ] <- c("Attitude items/indices (mean)", "", "", "")

balance_source[32, "variable"] <- "Study 1: Welfare state"
balance_source[32, "source0"] <-
  round(mean(data_1$topic1_attitude2_stand[data_1$topic1_source == 0], na.rm = T), 2)
balance_source[32, "source1"] <-
  round(mean(data_1$topic1_attitude2_stand[data_1$topic1_source == 1], na.rm = T), 2)
balance_source[32, "pvalue"] <-
  format(round(t.test(topic1_attitude2_stand ~ topic1_source, data = data_1)[["p.value"]], 2), nsmall = 2)

balance_source[33, "variable"] <- "Study 1: Domestic security"
balance_source[33, "source0"] <-
  round(mean(data_1$topic2_attitudes_factor[data_1$topic2_source == 0], na.rm = T), 2)
balance_source[33, "source1"] <-
  round(mean(data_1$topic2_attitudes_factor[data_1$topic2_source == 1], na.rm = T), 2)
balance_source[33, "pvalue"] <-
  format(round(t.test(topic2_attitudes_factor ~ topic2_source, data = data_1)[["p.value"]], 2), nsmall = 2)

balance_source[34, "variable"] <- "Study 1: Migration"
balance_source[34, "source0"] <-
  round(mean(data_1$topic3_attitudes_factor[data_1$topic3_source == 0], na.rm = T), 2)
balance_source[34, "source1"] <-
  round(mean(data_1$topic3_attitudes_factor[data_1$topic3_source == 1], na.rm = T), 2)
balance_source[34, "pvalue"] <-
  format(round(t.test(topic3_attitudes_factor ~ topic3_source, data = data_1)[["p.value"]], 2), nsmall = 2)

balance_source[35, "variable"] <- "Study 1: European integration"
balance_source[35, "source0"] <-
  round(mean(data_1$topic4_attitudes_factor[data_1$topic4_source == 0], na.rm = T), 2)
balance_source[35, "source1"] <-
  round(mean(data_1$topic4_attitudes_factor[data_1$topic4_source == 1], na.rm = T), 2)
balance_source[35, "pvalue"] <-
  format(round(t.test(topic4_attitudes_factor ~ topic4_source, data = data_1)[["p.value"]], 2), nsmall = 2)

balance_source[36, "variable"] <- "Study 2"
balance_source[36, "source0"] <-
  round(mean(data_2$immigrant_attitudes_factor[data_2$treatment_source == 0], na.rm = T), 2)
balance_source[36, "source1"] <-
  round(mean(data_2$immigrant_attitudes_factor[data_2$treatment_source == 1], na.rm = T), 2)
balance_source[36, "pvalue"] <-
  format(round(t.test(immigrant_attitudes_factor ~ treatment_source, data = data_2)[["p.value"]], 2), nsmall = 2)


### Table

balance_source %<>% 
  mutate(variable = 
           cell_spec(variable, "latex", 
                     italic = ifelse(variable == "Study 1: Welfare state" |
                                       variable == "Study 1: Domestic security" |
                                       variable == "Study 1: Migration" |
                                       variable == "Study 1: European integration" |
                                       variable == "Study 2", T, F))) %>%
  mutate(pvalue =
           cell_spec(pvalue, "latex", bold = ifelse(pvalue < 0.05, T, F)))


colnames(balance_source)[1] <- "Variable"
colnames(balance_source)[2] <- "Known source"
colnames(balance_source)[3] <- "Unknown source"
colnames(balance_source)[4] <- paste0("Significance", footnote_marker_alphabet(1))

balance_source[13, 1] <- paste0(balance_source[13, 1], "\\textsuperscript{b}")

kable(balance_source, 
      caption = "Balance statistics for source treatment", 
      format = "latex", booktabs = T, linesep = "", longtable = T, escape = F) %>%
  kable_styling(full_width = T,
                latex_options = c("scale_down", "HOLD_position"),
                font_size = 10) %>%
  column_spec(1, width = "6cm") %>%
  column_spec(4, width = "2cm") %>%
  add_indent(c(2:6, 8:12, 14:18, 20:24, 26:30, 32:36)) %>%
  footnote(alphabet = c("p-value of t-test for proportions and means; p-value of chi2-test for categorical variables. Differences significant at 5%-level in bold.", "Only one category of education variable displayed. Significance test refers to all categories."), threeparttable = T)

``` 

\newpage

# Attitude measurement

## Study 1

For each of the four topics, subjects were asked to indicate their agreement to four statements on a 11-point scale. Question wordings are provided below, as well as the distributions of single items (coded so that left end of the scale always represents are politically left position). Where used, distributions of factor scores are provided.   

### Welfare state {-}

* "The current wealth and income distribution in Germany is unjust." (reverse coded)
* "Someone working hard nowadays can improve their life situation without much difficulty."
* "The state should do more for the support of the unemployed even if that means raising taxes or incurring public debt." (reverse coded)
* "Wealth tax should be re-introduced." (reverse coded)

```{r study1-topic1-attitudes, fig.cap="Distributions of welfare state attitudes", fig.height=3.8, fig.width = 5.6, out.extra = '', fig.pos= "ht", fig.align = "center"}

topic1_attitude1_hist <- attitude_histogram(data_1$topic1_attitude1, data_1)
topic1_attitude1_hist <- topic1_attitude1_hist + 
  labs(y = "Frequency", x = 'Income/wealth distribution')

topic1_attitude2_hist <- attitude_histogram(data_1$topic1_attitude2, data_1)
topic1_attitude2_hist <- topic1_attitude2_hist + 
  labs(y = "", x = "Effect of working hard")

topic1_attitude3_hist <- attitude_histogram(data_1$topic1_attitude3, data_1)
topic1_attitude3_hist <- topic1_attitude3_hist + 
  labs(y = "Frequency", x = "Support for unemployed")

topic1_attitude4_hist <- attitude_histogram(data_1$topic1_attitude4, data_1)
topic1_attitude4_hist <- topic1_attitude4_hist + 
  labs(y = "", x = "Wealth tax")

ggarrange(topic1_attitude1_hist, 
         topic1_attitude2_hist,
         topic1_attitude3_hist, 
         topic1_attitude4_hist,
         ncol = 2, nrow = 2, 
         common.legend = TRUE,
         vjust = 0.5,
         font.label = list(size = 10),
         legend = "bottom")
```

### Domestic security {-}

* "Courts treat violent criminals too leniently." 
* "Overall, our country is well protected against terrorism."
* "The state should take a tougher stance on endangerers."
* "The state should implement more CCTV in the public space."

```{r study1-topic2-attitudes, fig.cap="Distributions of domestic security attitudes", fig.height=3.8, fig.width = 5.6, out.extra = '', fig.pos= "ht", fig.align = "center"}

topic2_attitude1_hist <- attitude_histogram(data_1$topic2_attitude1, data_1)
topic2_attitude1_hist <- topic2_attitude1_hist + 
  labs(y = "Frequency", x = 'Treatment of criminals')

topic2_attitude2_hist <- attitude_histogram(data_1$topic2_attitude2, data_1)
topic2_attitude2_hist <- topic2_attitude2_hist + 
  labs(y = "", x = "Terrorism protection")

topic2_attitude3_hist <- attitude_histogram(data_1$topic2_attitude3, data_1)
topic2_attitude3_hist <- topic2_attitude3_hist + 
  labs(y = "Frequency", x = "Stance on endangerers")

topic2_attitude4_hist <- attitude_histogram(data_1$topic2_attitude4, data_1)
topic2_attitude4_hist <- topic2_attitude4_hist + 
  labs(y = "", x = "Public CCTV")

ggarrange(topic2_attitude1_hist, 
          topic2_attitude2_hist,
          topic2_attitude3_hist, 
          topic2_attitude4_hist,
          ncol = 2, nrow = 2, 
          common.legend = TRUE,
          vjust = 0.5,
          font.label = list(size = 10),
          legend = "bottom")

```

```{r study1-topic2-factor, fig.cap="Distribution of domestic security factor scores", fig.height=1.9, fig.width = 2.8, out.extra = '', fig.pos= "ht", fig.align = "center"}

topic2_attitude_factor_hist <- attitude_histogram_fac(data_1$topic2_attitudes_factor, data_1)
topic2_attitude_factor_hist <- topic2_attitude_factor_hist + 
  labs(y = "Frequency", x = "Attitude factor")
topic2_attitude_factor_hist

```

\newpage

### Migration {-}

* "I appreciate that Germany has taken in many refugees." (reverse coded)
* "There should be an upper limit for number of refugees taken in."
* "The German state is more concerned about refugees than Germans in need."
* "The living standard of Germans will decrease because of the reception of refugees."

```{r study1-topic3-attitudes, fig.cap="Distributions of migration attitudes", fig.height=3.8, fig.width = 5.6, out.extra = '', fig.pos= "ht", fig.align = "center"}

topic3_attitude1_hist <- attitude_histogram(data_1$topic3_attitude1, data_1)
topic3_attitude1_hist <- topic3_attitude1_hist + 
  labs(y = "Frequency", x = 'Intake of refugees')

topic3_attitude2_hist <- attitude_histogram(data_1$topic3_attitude2, data_1)
topic3_attitude2_hist <- topic3_attitude2_hist + 
  labs(y = "", x = "Limit on refugees")

topic3_attitude3_hist <- attitude_histogram(data_1$topic3_attitude3, data_1)
topic3_attitude3_hist <- topic3_attitude3_hist + 
  labs(y = "Frequency", x = "Germans in need")

topic3_attitude4_hist <- attitude_histogram(data_1$topic3_attitude4, data_1)
topic3_attitude4_hist <- topic3_attitude4_hist + 
  labs(y = "", x = "Living standards")

ggarrange(topic3_attitude1_hist, 
          topic3_attitude2_hist,
          topic3_attitude3_hist, 
          topic3_attitude4_hist,
          ncol = 2, nrow = 2, 
          common.legend = TRUE,
          vjust = 0.5,
          font.label = list(size = 10),
          legend = "bottom")

```

```{r study1-topic3-factor, fig.cap="Distribution of migration factor scores", fig.height=1.9, fig.width = 2.8, out.extra = '', fig.pos= "ht", fig.align = "center"}

topic3_attitude_factor_hist <- attitude_histogram_fac(data_1$topic3_attitudes_factor, data_1)
topic3_attitude_factor_hist <- topic3_attitude_factor_hist + 
  labs(y = "", x = "Attitude factor")
topic3_attitude_factor_hist

```

\newpage

### European integration{-}

* "Germany should have a referendum on its EU membership."
* "The EU interferes too much with Europeans' lives."
* "Germany should pay less into the EU budget."
* "Countries with financial problems should be excluded from the Euro zone."

```{r study1-topic4-attitudes, fig.cap="Distributions of European integration attitudes", fig.height=3.8, fig.width = 5.6, out.extra = '', fig.pos= "ht", fig.align = "center"}

topic4_attitude1_hist <- attitude_histogram(data_1$topic4_attitude1, data_1)
topic4_attitude1_hist <- topic4_attitude1_hist + 
  labs(y = "Frequency", x = 'Treatment of criminals')

topic4_attitude2_hist <- attitude_histogram(data_1$topic4_attitude2, data_1)
topic4_attitude2_hist <- topic4_attitude2_hist + 
  labs(y = "", x = "Terrorism protection")

topic4_attitude3_hist <- attitude_histogram(data_1$topic4_attitude3, data_1)
topic4_attitude3_hist <- topic4_attitude3_hist + 
  labs(y = "Frequency", x = "Stance on endangerers")

topic4_attitude4_hist <- attitude_histogram(data_1$topic4_attitude4, data_1)
topic4_attitude4_hist <- topic4_attitude4_hist + 
  labs(y = "", x = "Public CCTV")

ggarrange(topic4_attitude1_hist, 
          topic4_attitude2_hist,
          topic4_attitude3_hist, 
          topic4_attitude4_hist,
          ncol = 2, nrow = 2, 
          common.legend = TRUE,
          vjust = 0.5,
          font.label = list(size = 10),
          legend = "bottom")

```

```{r study1-topic4-factor, fig.cap="Distribution of European integration factor scores", fig.height=1.9, fig.width = 2.8, out.extra = '', fig.pos= "ht", fig.align = "center"}

topic4_attitude_factor_hist <- attitude_histogram_fac(data_1$topic4_attitudes_factor, data_1)
topic4_attitude_factor_hist <- topic4_attitude_factor_hist + 
  labs(y = "", x = "Attitude factor")
topic4_attitude_factor_hist

```

\newpage

## Study 2

Subjects were asked to indicate their positions on five 11-point items around migration and migration policies. Question wordings and distribution of the single items/factor as follows.

* "Would you say that cultural life in Germany is generally undermined or enriched by immigrants? 0 means undermined, 10 means enriched." 
* "Would you say that it is generally bad or good for the German economy that immigrants come here? 0 means bad, 10 means good."
* "Would you say that Germany becomes less safe or safer with immigrants? 0 means less safe and 10 means safer."
* "Would you say that immigrants make Germany a worse or better place to live? 0 means worse and 10 means better."
* "Would you say that Europe sufficiently protects its external borders against illegal immigration? 0 means protection is not sufficient, 10 means protection is sufficient."

```{r study2-migration-attitudes, fig.cap="Distributions of migration attitudes", fig.height=4.5, fig.width = 5.5, out.extra = '', fig.pos= "ht", fig.align = "center"}

attitude_culture_hist <- attitude_histogram(data_2$immigrant_attitude_culture, data_2)
attitude_culture_hist <- attitude_culture_hist + 
  labs(y = "Frequency", x = 'Cultural life')

attitude_economy_hist <- attitude_histogram(data_2$immigrant_attitude_economy, data_2)
attitude_economy_hist <- attitude_economy_hist + 
  labs(y = "", x = "Economy")

attitude_safety_hist <- attitude_histogram(data_2$immigrant_attitude_security, data_2)
attitude_safety_hist <- attitude_safety_hist + 
  labs(y = "Frequency", x = "Safety")

attitude_place_hist <- attitude_histogram(data_2$immigrant_attitude_life, data_2)
attitude_place_hist <- attitude_place_hist + 
  labs(y = "", x = "Place to live")

attitude_borders_hist <- attitude_histogram(data_2$immigrant_attitude_border, data_2)
attitude_borders_hist <- attitude_borders_hist + 
  labs(y = "", x = "Borders")

ggarrange(attitude_culture_hist, 
         attitude_economy_hist,
         attitude_safety_hist, 
         attitude_place_hist,
         attitude_borders_hist,
         ncol = 2, nrow = 3, 
         common.legend = TRUE,
         vjust = 0.5,
         font.label = list(size = 10),
         legend = "bottom")

```

```{r study2-migration-factor, fig.cap="Distribution of migration factor scores", fig.height=1.9, fig.width = 2.8, out.extra = '', fig.pos= "ht", fig.align = "center"}

attitude_factor_hist <- attitude_histogram_fac(data_1$immigrant_attitudes_factor, data_2)
attitude_factor_hist <- attitude_factor_hist + 
  labs(y = "", x = "Attitude factor")
topic4_attitude_factor_hist

```

# Stimuli and content manipulations

## Study 1

For each topic, the main stimulus was a screenshot of a Facebook post containing a news report. The post was built like a typical news post and included a headline, a photo, a teaser, the name and logo of the source as well as its URL. Contents were manipulated so that the two content treatments contained opposing factual claims. For the topics of migration and European integration, a couple of paragraphs of the report were shown in addition to the Facebook post, introduced by the words: "For this story, we will show you a few paragraphs of the linked text (Source: [source])". Figure \@ref(fig:study1-screenshots) illustrates the two treatment dimensions. Wording of news reports below (translated from German).

**Welfare state**

Pro-welfare state report: 

* Headline: *Hartz IV benefit cuts: Sanctions push unemployed into ill-paid jobs*
* Teaser: *Benefit cuts for those who violate Hartz IV requirements fall short of desired effects: Our data show that sanctioned move into ill-paid jobs. The risk of becoming a working poor increases.*

Anti-welfare state report:  

* Headline: *Hartz IV benefit cuts: Sanctions speed up entry into regular employment*
* Teaser: *Benefit cuts for those who violate Hartz IV requirements are effective: Our data suggest that sanctioned unemployed move more often and more quickly into regular employment.*

**Domestic security**

Anti-law-and-order report: 

* Headline: *Europe-wide comparison: Arrest of endangerers does not decrease risk of terrorism*
* Teaser: *Is the pre-emptive arrest of endangerers reasonable? European countries with stricter measures have not experienced less terrorist attacks in the last ten years, as a study shows. *

Pro-law-and-order report: 

* Headline: *Europe-wide comparison: Fewer terrorist attacks in countries with strict arrest of endangerers*
* Teaser: *Is the pre-emptive arrest of endangerers reasonable? European countries with stricter measures have experienced less terrorist attacks in the last ten years, as a study shows.*

**Migration**

Pro-migration report: 

* Headline: *Traineeships: Completion rates in craft as high for refugees as for natives*
* Teaser: *Refugees complete their craft traineeships by now as often as other trainees, as numbers by the Chamber of Crafts show.*
* Paragraphs: *Refugees complete their traineeships German handicraft businesses as often as native trainees. About three quarter of trainees who had fled from Syria, Afghanistan and Iraq and had started a traineeship since the beginning of 2013 have by now completed or are still in training, as a Germany-wide investigation by [source] revealed. Their completion rate (74.8 percent) corresponds roughly to that of all other trainees (73.5 percent). For the investigation, data from the Chambers of Craft of all German states were analysed. The Chambers have initiated various programmes for the integration of refugees into the labour market and recorded the numbers of allocated and successfully trained refugees. The dropout rates are not equally high for all states and fluctuate between 85 percent (Saarland) and 65 percent (Lower Saxony). On average, the rate is 74.8 percent. Anecdotal numbers from earlier periods had painted a much worse picture. When asked for the reasons for the apparent rise of completion rates, several representatives of businesses and Chambers refer to more realistic expectations of refugees. `In the beginning, many have the idea of earning lots of money in Germany quickly and send it back home', said Lothar Semper from the Chamber Munich and Upper Bavaria. Now they understand, he said that in the long run opting for a traineeship is a better decision. The majority accepts the comparably low wage during the traineeship and show a particularly high motivation.*

Anti-migration report: 

* Headline: *Craft: Nine out of ten refugees cancel their traineeship*
* Teaser: *Refugees discontinue their craft traineeships more often than average, as numbers by the Chamber of Crafts show.*
* Paragraphs: *Refugees discontinue their traineeships in German handicraft businesses more often than average. Almost 90 percent of trainees who had fled from Syria, Afghanistan and Iraq and had started a traineeship since the beginning of 2013 have dropped out without finishing, as a Germany-wide investigation by [source] revealed. For all other trainees, the dropout rate is substantially lower at around 25 percent. For the investigation, data from the Chambers of Craft of all German states were analysed. The Chambers have initiated various programmes for the integration of refugees into the labour market and recorded the numbers of allocated and successfully trained refugees. The dropout rates are not equally high for all states and fluctuate between 60 percent (Saarland) and 95 percent (Lower Saxony). On average, the rate is 89.5 percent. When asked for the reasons, several representatives of businesses and Chambers refer to unrealistic expectations on the refugees' part. 'Many have the idea of earning lots of money in Germany quickly and send it back home', said Lothar Semper from the Chamber Munich and Upper Bavaria. It is necessary to communicate to them, he said, that in the long run it is worth opting for a traineeship and earn less at the start. Given the comparably low wage during the traineeship much persuasion is necessary to bring young people to start a traineeship in the first place.*

**European integration**

Pro-integration report: 

* Headline: *EU programme to reduce regulations shows effects*
* Teaser: *Since two years ago, a programme of the EU Commission is meant to repeal unnecessary legislation. With success: Over 60 pieces of regulation have been abolished, which financially relieved small entreprises in particular.*
* Paragraphs: *A EU programme for more efficiency in legislation has led to less regulation and financial relief for citizens and businesses. This is the result of an investigation by [source]. In the years of 2015 and 2016, the working group 'Refit' made 119 proposals to the Commission how EU regulations could be repealed or modified. Both of the 53 proposed modifications and the 66 pieces of regulation to be abolished, most were already follwed through. Only eight pieces of regulation remain to be repealed. According to the Commissions estimations, the 'Refit' changes could mean yearly savings for citizens and entreprises of 1.5 billion Euros alone. In comparison, the programme 'Refit' has only produced costs of 5 million Euros. Small and medium business owners interviewed by [source] have confirmed that many of the repealed rules could mean financial relief. The programme 'Refit' was born in 2015 to make EU law "simpler and less costly". Regulation can be regularly examined and changed or repealed as needed. This is meant to cut red tape and reduce costs for small entreprises in particular. Through an online platform, citizens, business and member states can make proposals on modifications and repeals.*

Anti-integration report: 

* Headline: *EU programme to reduce regulations unsuccessful, but costly*
* Teaser: *Since two years ago, a programme of the EU Commission is meant to repeal unnecessary legislation. This has not happened: Not a single regulation has been abolished, but the programme has created additional costs.*
* Paragraphs: *A EU programme for more efficiency in legislation has not led to less regulation, but higher costs. This is the result of an investigation by [source]. In the years of 2015 and 2016, the working group 'Refit' made 119 proposals to the Commission how EU regulations could be repealed or modified. Of these, only the 53 proposed modifications were implemented. Those 66 pieces of regulation that were supposed to be abolished exist until today. The working group, however, produced additional costs for staff and technical infrastructure of 25 million Euros. Via the EU budget, Germany contributed 3.8 million. The programme 'Refit' was born in 2015 to make EU law "simpler and less costly". Regulation can be regularly examined and changed or repealed as needed. This is meant to cut red tape and reduce costs for small entreprises in particular. Through an online platform, citizens, business and member states can make proposals on modifications and repeals. Why the Commission has not repealed a single legislation during the first two years of Refit's existence although there is a choice of over 60 pieces of regulation is uncelar. The Commission declined to comment questions on the investigation from [source]. *

**True control story**

* Headline: *State parliament election in North Rhine-Westphalia: The Free Democratic Party gains 28 seats*
* Teaser: *The official final result is confirmed: Free Democratic Party gets 28 out of 199 seats in North Rhine-Westphalia parliamentary elections.*

\begin{figure}[htb]
\caption{Example of screenshots used in the treatments (Study 1)}
  \begin{subfigure}{8cm}
    \centering\includegraphics[width=8cm]{figures/Study 1 TS Left}
    \caption{Known source, left-wing content}
  \end{subfigure}
  \begin{subfigure}{8cm}
    \centering\includegraphics[width=8cm]{figures/Study 1 TS Right}
    \caption{Known source, right-wing content}
  \end{subfigure}

  \begin{subfigure}{8cm}
    \centering\includegraphics[width=8cm]{figures/Study 1 NN Left}
    \caption{Unknown source, right-wing content}
  \end{subfigure}
  \begin{subfigure}{8cm}
    \centering\includegraphics[width=8cm]{figures/Study 1 NN Right}
    \caption{Unknown source, left-wing content}
  \end{subfigure}
\label{fig:study1-screenshots}
\end{figure}

\clearpage

## Study 2

The news reports subjects read in Study 2 was again introduced by a screenshot, followed by a couple of paragraphs. In contrast to Study 1, the screenshot was either showing a Facebook post or a news web site. Although this treatment dimension is not included in the analysis, it is illustrated here for completeness. Note that the Facebook posts look somewhat different due to design changes on the social media platform in the time between the two studies. Figure \@ref(fig:study2-screenshots) provides the screenshots across the tree treatment dimensions.

Pro-migration report:

* Headline: *Immigrants not over-represented among suspected criminals*
* Teaser: *Numbers from the newest police statistics show: Immigrants in Germany are not overproportionally crime suspects*
* Paragraphs: *Last year, 1.9 percent of all crime suspects in Germany were immigrants. In total, there were 1.97 million suspects registered, of which 37,233 were immigrants. This emerges from the Police Crime Statistics 2017 ("Polizeilichen Kriminalstatistik") which [source] has analysed in advance. The Crime Statistics 2017 include as immigrants asylum seekers, persons with exceptional leave to remain for humanitarian reasons ("Geduldete"), "illegal residents", persons under subsidiary protection ("subsidiär Geschützte") as well as the few quota refugees who have been accepted through international aid programmes. At the end of 2017, the group of immigrants thus defined made up about two percent of the population. Therefore, there were about as much probable causes against immigrants as is their share of the overall population. In the statistics, crimes against immigration laws were excluded as they cannot be committed by Germans. The data confirms a trend [source] had reported about in the previous year. Immigrants are not overproportionally part of overall registered crime.*

Anti-migration report:

* Headline:  *Immigrants over-represented among suspected criminals* 
* Teaser: *Numbers from the newest police statistics show: Immigrants in Germany are overproportionally crime suspects*
* Paragraphs: *Last year, 15.1 percent of all crime suspects in Germany were immigrants. In total, there were 1.97 million suspects registered, of which 297,273 were immigrants. This emerges from the Police Crime Statistics 2017 ("Polizeilichen Kriminalstatistik") which [source] has analysed in advance. The Crime Statistics 2017 include as immigrants asylum seekers, persons with exceptional leave to remain for humanitarian reasons ("Geduldete"), "illegal residents", persons under subsidiary protection ("subsidiär Geschützte") as well as the few quota refugees who have been accepted through international aid programmes. At the end of 2017, the group of immigrants thus defined made up about two percent of the population. Therefore, there were more probable causes against immigrants as is their share of the overall population. In the statistics, crimes against immigration laws were excluded as they cannot be committed by Germans. The data confirms a trend [source] had reported about in the previous year. Immigrants are overproportionally part of overall registered crime.*

\begin{figure}[htb]
\caption{Example of screenshots used in the treatments (Study 2)}
  \begin{subfigure}{8cm}
    \centering\includegraphics[width=7.2cm]{figures/2_Build1 +pro TS FB Desk}
    \caption{Known source, left-wing content, Facebook}
  \end{subfigure}
  \begin{subfigure}{8cm}
    \centering\includegraphics[width=7.2cm]{figures/2_Build1 anti TS FB Desk}
    \caption{Known source, right-wing content, Facebook}
  \end{subfigure}

  \begin{subfigure}{8cm}
    \centering\includegraphics[width=7.2cm]{figures/2_Build1 +pro TS Web Desk}
    \caption{Unknown source, right-wing content, Website}
  \end{subfigure}
  \begin{subfigure}{8cm}
    \centering\includegraphics[width=7.2cm]{figures/2_Build1 anti TS Web Desk}
    \caption{Unknown source, left-wing content, Website}
  \end{subfigure}
\end{figure}

\begin{figure}[ht]\ContinuedFloat
  \begin{subfigure}{8cm}
    \centering\includegraphics[width=7.2cm]{figures/2_Build1 +pro N360 FB Desk}
    \caption{Unknown source, left-wing content, Facebook}
  \end{subfigure}
  \begin{subfigure}{8cm}
    \centering\includegraphics[width=7.2cm]{figures/2_Build1 anti N360 FB Desk}
    \caption{Unknown source, right-wing content, Facebook}
  \end{subfigure}
\label{fig:study2-screenshots}

  \begin{subfigure}{8cm}
    \centering\includegraphics[width=7.2cm]{figures/2_Build1 +pro N360 Web Desk}
    \caption{Unknown source, left-wing content, Website}
  \end{subfigure}
  \begin{subfigure}{8cm}
    \centering\includegraphics[width=7.2cm]{figures/2_Build1 anti N360 Web Desk}
    \caption{Unknown source, right-wing content, Website}
  \end{subfigure}
\label{fig:study2-screenshots}
\end{figure}

\clearpage

# Source knowledge pre-testing

A list of 30 sources, including the "known" source later used in the experiment (Tagesschau) was pre-tested before Study 1. Figure \@ref(fig:fig-study1-pretest) shows the percentages of people knowing a source. A list of 11 sources, among them both the "known" and "unknown" source, was included in Study 2 before the experimental stage. Figure \@ref(fig:fig-study2-pretest) shows that the unknown source, which is made-up, seems to elicit an illusion of familiarity. 

```{r study1-pretest, fig.cap="Source knowledge in Study 1 pre-test\\label{fig:fig-study1-pretest}", out.extra = '', fig.pos= "h", fig.align = "center", fig.width = 9, fig.height=4}

study1_pretest <- read.csv(file = "Data Pretest August 2017.csv", 
                           stringsAsFactors = FALSE, 
                           encoding = "UTF-8")

study1_pretest %<>% 
  rename("Spiegel" = Q14.1_1) %>%
  rename("Tagesschau" = Q14.1_2) %>%
  rename("ZDF Heute" = Q14.1_3) %>%
  rename("Welt" = Q14.1_4) %>%
  rename("SZ" = Q14.1_5) %>%
  rename("Zeit" = Q14.1_6) %>%
  rename("FAZ" = Q14.1_7) %>%
  rename("Bild" = Q14.1_8) %>%
  rename("Focus" = Q14.1_9) %>%
  rename("Express" = Q14.1_10) %>%
  rename("Huffington Post" = Q14.1_11) %>%
  rename("T-Online" = Q14.1_12) %>%
  rename("web.de" = Q14.1_13) %>%
  rename("DPA" = Q14.1_14) %>%
  rename("Reuters" = Q14.1_15) %>%
  rename("Junge Freiheit" = Q14.1_16) %>%
  rename("Achse des Guten" = Q14.1_17) %>%
  rename("Tichy's Einblick" = Q14.1_18) %>%
  rename("PI News" = Q14.1_19) %>%
  rename("TAZ" = Q14.1_20) %>%
  rename("Neues Deutschland" = Q14.1_21) %>%
  rename("Jungle World" = Q14.1_22) %>%
  rename("Junge Welt" = Q14.1_23) %>%
  rename("24aktuelles" = Q14.1_24) %>%
  rename("Kölner Abendblatt" = Q14.1_25) %>%
  rename("Anonymous Russia"= Q14.1_26) %>%
  rename("Newsblitz" = Q14.1_27) %>%
  rename("Internetzzeitung" = Q14.1_28) %>%
  rename("Chintzyherald" = Q14.1_29) %>%
  rename("NTV" = Q14.1_30) 

mainstream <-  c("Spiegel", "Tagesschau", "ZDF Heute", "Welt", "SZ", 
         "Zeit", "FAZ", "Bild", "Focus", "Express", "TAZ",
         "Huffington Post", "T-Online", "web.de", "DPA", "Reuters", "NTV")
hyperpartisan <- c("Junge Freiheit", "Achse des Guten", "Tichy's Einblick", "PI News", 
         "Neues Deutschland", "Jungle World", "Junge Welt")
fakenews <- c("24aktuelles", "Kölner Abendblatt", 
         "Anonymous Russia", "Newsblitz", "Internetzzeitung", "Chintzyherald")

study1_pretest <- study1_pretest %>% 
  select("Spiegel", "Tagesschau", "ZDF Heute", "Welt", "SZ", 
         "Zeit", "FAZ", "Bild", "Focus", "Express", 
         "Huffington Post", "T-Online", "web.de", "DPA", "Reuters", 
         "Junge Freiheit", "Achse des Guten", "Tichy's Einblick", "PI News", "TAZ", 
         "Neues Deutschland", "Jungle World", "Junge Welt", "24aktuelles", "Kölner Abendblatt", 
         "Anonymous Russia", "Newsblitz", "Internetzzeitung", "Chintzyherald", "NTV") %>%
  gather(key = "variable", value = "value") %>% 
  mutate(value = case_when(value == "Kenne ich" ~ "1",
                           value == "Kenne ich nicht" ~ "0",
                           TRUE ~ as.character(value))) %>%
  mutate(value = as.numeric(value)) %>% 
  group_by(variable) %>%
  summarize(N = n(),
            mean = mean(value, na.rm = TRUE),
            var = var(value, na.rm = TRUE),
            sd = sd(value, na.rm = TRUE),
            na_sum = sum(is.na(value))) %>% 
            mutate(n = N - na_sum) %>%
  ungroup()

study1_pretest %<>% mutate(type = case_when(variable %in% mainstream ~ "Mainstream",
                                      variable %in% hyperpartisan ~ "Hyperpartisan",
                                      variable %in% fakenews ~ "Fake news"))

ggplot(study1_pretest, aes(x = reorder(variable, -mean), y = mean)) +
  geom_bar(stat="identity", 
           width=0.7, 
           position = position_dodge(width=0.8),
           aes(fill = factor(type)), size = 0.4) +
  scale_fill_manual(name="Type of news source",
                    values = c("darkolivegreen3", "firebrick1", "deepskyblue3"),
                    labels = c("Hyperpartisan (real)","Made-up","Mainstream (real)")) +
  xlab("") + 
  ylab("Percentage") + 
  scale_y_continuous(breaks = c(0,0.25,0.5, 0.75, 1),
                     limits = c(0, 1)) +
  theme(axis.text.x = element_text(angle=35, hjust = 1, vjust = 1, margin = margin(0.2,0,0.3,0,"cm")),
        panel.border = element_rect(colour = "#DCDCDC", fill = NA, size = 1.5),
        panel.background = element_blank(),
        panel.grid.major = element_line(size = .5, colour = "#EEEEEE"),
        panel.grid.minor.y = element_line(size = .3, colour = "#EEEEEE"),
        panel.grid.major.x = element_blank(),
        plot.title = element_text(hjust = 0.5),
        # plot.margin = margin(0.5, 0.5, 0, 0.5, "cm"),
      legend.title=element_text(size=10),
      legend.text = element_text(size=9)) +
  guides(linetype = guide_legend(override.aes = list(fill = NA, col = "black")))


```

```{r study2-pretest, fig.cap="Source knowledge in Study 2\\label{fig:fig-study2-pretest}", out.extra = '', fig.pos= "h", fig.align = "center", fig.height=3.7}


study2_pretest <- data_2 %>% 
  select("knowsource_tagesschau", "knowsource_heute", "knowsource_sz",
         "knowsource_faz", "knowsource_focus", "knowsource_bild", 
         "knowsource_nachrichten360", "knowsource_berliner", "knowsource_spiegel",
         "knowsource_rtdeutsch", "knowsource_newsblitz") %>% 
  gather(key = "variable", value = "value") %>% 
  mutate(value = case_when(value == "Ja" ~ "1",
                           value == "Nein" ~ "0",
                           TRUE ~ as.character(value))) %>%
  mutate(value = as.numeric(value)) %>% 
  group_by(variable) %>%
  summarize(N = n(),
            mean = mean(value, na.rm = TRUE),
            var = var(value, na.rm = TRUE),
            sd = sd(value, na.rm = TRUE),
            na_sum = sum(is.na(value))) %>% 
  mutate(n = N - na_sum) %>% 
  mutate(se = sqrt(var/n),
         ci.error = qt(0.975,df=n-1)*sd/sqrt(n),
         conf.low = mean - ci.error,
         conf.high = mean + ci.error) 

study2_pretest$type <- dplyr::recode(study2_pretest$variable,
                                knowsource_tagesschau = "Mainstream",
                                knowsource_heute = "Mainstream",
                                knowsource_sz = "Mainstream",
                                knowsource_faz = "Mainstream",
                                knowsource_focus = "Mainstream",
                                knowsource_bild = "Mainstream",
                                knowsource_nachrichten360 = "Made-up",
                                knowsource_berliner = "Made-up",
                                knowsource_spiegel = "Mainstream",
                                knowsource_rtdeutsch = "Hyperpartisan",
                                knowsource_newsblitz = "Hyperpartisan")
  
study2_pretest$variable <- dplyr::recode(study2_pretest$variable,
                                   knowsource_tagesschau = "Tagesschau",
                                   knowsource_heute = "Heute",
                                  knowsource_sz = "SZ",
                                  knowsource_faz = "FAZ",
                                  knowsource_focus = "Focus",
                                  knowsource_bild = "Bild",
                                  knowsource_nachrichten360 = "Nachrichten 360",
                                  knowsource_berliner = "Berliner Nachrichten",
                                  knowsource_spiegel = "Spiegel",
                                  knowsource_rtdeutsch = "RTDeutsch",
                                  knowsource_newsblitz = "Newsblitz")

ggplot(study2_pretest, aes(x = reorder(variable, -mean), y = mean)) +
  geom_bar(stat="identity", 
           width=0.7, 
           position = position_dodge(width=0.8),
           aes(fill = factor(type)), size = 0.4) +
  scale_fill_manual(name="Type of news source",
                    values = c("darkolivegreen3", "firebrick1", "deepskyblue3"),
                    labels = c("Hyperpartisan (real)","Made-up","Mainstream (real)")) +
  xlab("") + 
  ylab("Percentage") + 
  scale_y_continuous(breaks = c(0,0.25,0.5, 0.75, 1),
                     limits = c(0, 1)) +
  theme(axis.text.x = element_text(angle=35, hjust = 1, vjust = 1, margin = margin(0.2,0,0.3,0,"cm")),
        panel.border = element_rect(colour = "#DCDCDC", fill = NA, size = 1.5),
        panel.background = element_blank(),
        panel.grid.major = element_line(size = .5, colour = "#EEEEEE"),
        panel.grid.minor.y = element_line(size = .3, colour = "#EEEEEE"),
        panel.grid.major.x = element_blank(),
        plot.title = element_text(hjust = 0.5),
        # plot.margin = margin(0.5, 0.5, 0, 0.5, "cm"),
      legend.title=element_text(size=10),
      legend.text = element_text(size=9)) +
  guides(linetype = guide_legend(override.aes = list(fill = NA, col = "black")))

```

\clearpage

# Marginal effect plots H1b (Study 2) 

The plots below illustrate the marginal effects of the content treatment on sharing tendency for different attitude positions between the 5% and the 95% quantile (x-axis). The y-axis depicts the predicted difference in sharing tendency between the two news reports. A negative value indicates that the sharing tendency of the pro-migration report was higher than the right-wing report, a positive value the opposite.

```{r study2-fullmodels, results = "asis", paged.print = FALSE}

#### Logit regression ####
# Content treatment: 0 is pro-migration content, 1 is anti-migration content
# Attitude: low is pro-migration, high is anti-migration

study2 <- list()

#### Email ####

study2$email_h1b <- glm(share_report_2_email ~ 
                    treatment_content*immigrant_attitudes_factor, 
                data = data_2, family = "binomial")
study2$email_h2b <- glm(share_report_2_email ~ 
                  treatment_source,
                data = data_2, family = "binomial")
study2$email_h3b <- glm(share_report_2_email ~ 
                  treatment_source*trustsource_mainstream,
                data = data_2, family = "binomial")
study2$email_h4b <- glm(share_report_2_email ~ 
                  treatment_content*immigrant_attitudes_factor*treatment_source,
                data = data_2, family = "binomial")

#### FB ####

study2$fb_h1b <- glm(share_report_2_fb ~ 
                  treatment_content*immigrant_attitudes_factor, 
                data = data_2, family = "binomial")
study2$fb_h2b <- glm(share_report_2_fb ~ 
                  treatment_source,
                data = data_2, family = "binomial")
study2$fb_h3b <- glm(share_report_2_fb ~ 
                  treatment_source*trustsource_mainstream,
                data = data_2, family = "binomial")
study2$fb_h4b <- glm(share_report_2_fb ~ 
                  treatment_content*immigrant_attitudes_factor*treatment_source,
                data = data_2, family = "binomial")

#### Twitter ####

study2$twitter_h1b <- glm(share_report_2_twitter ~ 
                  treatment_content*immigrant_attitudes_factor, 
                data = data_2, family = "binomial")
study2$twitter_h2b <- glm(share_report_2_twitter ~ 
                  treatment_source,
                data = data_2, family = "binomial")
study2$twitter_h3b <- glm(share_report_2_twitter ~ 
                  treatment_source*trustsource_mainstream,
                data = data_2, family = "binomial")
study2$twitter_h4b <- glm(share_report_2_twitter ~ 
                  treatment_content*immigrant_attitudes_factor*treatment_source,
                data = data_2, family = "binomial")
study2$twitter_full <- glm(share_report_2_twitter ~ 
                  treatment_content*immigrant_attitudes_factor*treatment_source +
                    treatment_source*trustsource_mainstream,
                data = data_2, family = "binomial")

#### Whatsapp ####

study2$whatsapp_h1b <- glm(share_report_2_whatsapp ~ 
                  treatment_content*immigrant_attitudes_factor, 
                data = data_2, family = "binomial")
study2$whatsapp_h2b <- glm(share_report_2_whatsapp ~ 
                  treatment_source,
                data = data_2, family = "binomial")
study2$whatsapp_h3b <- glm(share_report_2_whatsapp ~ 
                  treatment_source*trustsource_mainstream,
                data = data_2, family = "binomial")
study2$whatsapp_h4b <- glm(share_report_2_whatsapp ~ 
                  treatment_content*immigrant_attitudes_factor*treatment_source,
                data = data_2, family = "binomial")


```

```{r study2-h1a-margins, results = "hide", fig.cap = "Marginal congruence effects on sharing tendency\\label{fig:figure-h1a-margins}", fig.height = 4.5, out.extra = '', fig.pos= "h"}

#### Email ####

### Define extreme values for plotting

immigrant_05_email <- data_2 %>% 
  filter(!is.na(share_report_2_email)) %>%
  summarize(quants = quantile(immigrant_attitudes_factor, probs = 0.05))
immigrant_05_email <- as.vector(immigrant_05_email[[1]])

immigrant_95_email <- data_2 %>% 
  filter(!is.na(share_report_2_twitter)) %>%
  summarize(quants = quantile(immigrant_attitudes_factor, probs = 0.95))
immigrant_95_email <- as.vector(immigrant_95_email[[1]])

### Predict margins

email_margins_diff_h1b <- 
  marg(study2$email_h1b,
       var_interest = "treatment_content",
       at = list("immigrant_attitudes_factor" = 
                   c(immigrant_05_email,
                     -1, -0.5, 0, 0.5, 1, 1.5,
                     immigrant_95_email)),
       type = "effects")

### Data frame for graph

email_margins_diff_h1b_delta <- data.frame(at = NA, delta = NA, se = NA)

for (i in 1:length(email_margins_diff_h1b)) {
  email_margins_diff_h1b_delta[i, "at"] <- names(email_margins_diff_h1b[i])
  email_margins_diff_h1b_delta[i, "delta"] <- email_margins_diff_h1b[[i]][["Margin"]][2]
  email_margins_diff_h1b_delta[i, "se"] <- email_margins_diff_h1b[[i]][["Standard.Error"]][2]
}

email_margins_diff_h1b_delta %<>%
  mutate(at = gsub("immigrant_attitudes_factor = ", "", at)) %>%
  mutate(at = as.numeric(at)) %>%
  mutate(conf_low = delta - se) %>%
  mutate(conf_high = delta + se)

### Plot differences

## Attitude dimension as new data frame

email_attitude_df = data.frame(attitude =
                                 data_2$immigrant_attitudes_factor[!is.na(data_2$share_report_2_email)],
                               y = 0)

## Plot

email_h1b_marginsplot <- h1a_marginsplot(email_margins_diff_h1b_delta, 
                                         x_lab = "Migration attitude factor", 
                                         x_lim_low = -2, x_lim_high = 2.2, 
                                         rug_data = email_attitude_df,
                                           y_lim_low = -0.5, y_lim_high = 0.5)

#### FB ####

### Define extreme values for plotting

immigrant_05_fb <- data_2 %>% 
  filter(!is.na(share_report_2_fb)) %>%
  summarize(quants = quantile(immigrant_attitudes_factor, probs = 0.05))
immigrant_05_fb <- as.vector(immigrant_05_fb[[1]])

immigrant_95_fb <- data_2 %>% 
  filter(!is.na(share_report_2_twitter)) %>%
  summarize(quants = quantile(immigrant_attitudes_factor, probs = 0.95))
immigrant_95_fb <- as.vector(immigrant_95_fb[[1]])

### Predict margins

fb_margins_diff_h1b <- 
  marg(study2$fb_h1b,
       var_interest = "treatment_content",
       at = list("immigrant_attitudes_factor" = 
                   c(immigrant_05_fb,
                     -1, -0.5, 0, 0.5, 1, 1.5,
                     immigrant_95_fb)),
       type = "effects")

### Data frame for graph

fb_margins_diff_h1b_delta <- data.frame(at = NA, delta = NA, se = NA)

for (i in 1:length(fb_margins_diff_h1b)) {
  fb_margins_diff_h1b_delta[i, "at"] <- names(fb_margins_diff_h1b[i])
  fb_margins_diff_h1b_delta[i, "delta"] <- fb_margins_diff_h1b[[i]][["Margin"]][2]
  fb_margins_diff_h1b_delta[i, "se"] <- fb_margins_diff_h1b[[i]][["Standard.Error"]][2]
}

fb_margins_diff_h1b_delta %<>%
  mutate(at = gsub("immigrant_attitudes_factor = ", "", at)) %>%
  mutate(at = as.numeric(at)) %>%
  mutate(conf_low = delta - se) %>%
  mutate(conf_high = delta + se)

### Plot differences

## Attitude dimension as new data frame

fb_attitude_df = data.frame(attitude =
                                 data_2$immigrant_attitudes_factor[!is.na(data_2$share_report_2_fb)],
                               y = 0)

## Plot

fb_h1b_marginsplot <- h1a_marginsplot(fb_margins_diff_h1b_delta, 
                                      x_lab = "Migration attitude factor", 
                                       x_lim_low = -2, x_lim_high = 2.2, 
                                       rug_data = fb_attitude_df,
                                           y_lim_low = -0.5, y_lim_high = 0.5)

#### Twitter ####

### Define extreme values for plotting

immigrant_05_twitter <- data_2 %>% 
  filter(!is.na(share_report_2_twitter)) %>%
  summarize(quants = quantile(immigrant_attitudes_factor, probs = 0.05))
immigrant_05_twitter <- as.vector(immigrant_05_twitter[[1]])

immigrant_95_twitter <- data_2 %>% 
  filter(!is.na(share_report_2_twitter)) %>%
  summarize(quants = quantile(immigrant_attitudes_factor, probs = 0.95))
immigrant_95_twitter <- as.vector(immigrant_95_twitter[[1]])

### Predict margins

twitter_margins_diff_h1b <- 
  marg(study2$twitter_h1b,
       var_interest = "treatment_content",
       at = list("immigrant_attitudes_factor" = 
                   c(immigrant_05_twitter,
                     -1, -0.5, 0, 0.5, 1, 1.5,
                     immigrant_95_twitter)),
       type = "effects")

### Data frame for graph

twitter_margins_diff_h1b_delta <- data.frame(at = NA, delta = NA, se = NA)

for (i in 1:length(twitter_margins_diff_h1b)) {
  twitter_margins_diff_h1b_delta[i, "at"] <- names(twitter_margins_diff_h1b[i])
  twitter_margins_diff_h1b_delta[i, "delta"] <- twitter_margins_diff_h1b[[i]][["Margin"]][2]
  twitter_margins_diff_h1b_delta[i, "se"] <- twitter_margins_diff_h1b[[i]][["Standard.Error"]][2]
}

twitter_margins_diff_h1b_delta %<>%
  mutate(at = gsub("immigrant_attitudes_factor = ", "", at)) %>%
  mutate(at = as.numeric(at)) %>%
  mutate(conf_low = delta - se) %>%
  mutate(conf_high = delta + se)

### Plot differences

## Attitude dimension as new data frame

twitter_attitude_df = data.frame(attitude = data_2$immigrant_attitudes_factor[!is.na(data_2$share_report_2_twitter)],
                               y = 0)

## Plot

twitter_h1b_marginsplot <- h1a_marginsplot(twitter_margins_diff_h1b_delta,
                                           x_lab = "Migration attitude factor", 
                                           x_lim_low = -2, x_lim_high = 2.2, 
                                           rug_data = twitter_attitude_df,
                                           y_lim_low = -0.5, y_lim_high = 0.5)

#### Whatsapp ####

### Define extreme values for plotting

immigrant_05_whatsapp <- data_2 %>% 
  filter(!is.na(share_report_2_whatsapp)) %>%
  summarize(quants = quantile(immigrant_attitudes_factor, probs = 0.05))
immigrant_05_whatsapp <- as.vector(immigrant_05_whatsapp[[1]])

immigrant_95_whatsapp <- data_2 %>% 
  filter(!is.na(share_report_2_whatsapp)) %>%
  summarize(quants = quantile(immigrant_attitudes_factor, probs = 0.95))
immigrant_95_whatsapp <- as.vector(immigrant_95_whatsapp[[1]])

### Predict margins

whatsapp_margins_diff_h1b <- 
  marg(study2$whatsapp_h1b,
       var_interest = "treatment_content",
       at = list("immigrant_attitudes_factor" = 
                   c(immigrant_05_whatsapp,
                     -1, -0.5, 0, 0.5, 1, 1.5,
                     immigrant_95_whatsapp)),
       type = "effects")

### Data frame for graph

whatsapp_margins_diff_h1b_delta <- data.frame(at = NA, delta = NA, se = NA)

for (i in 1:length(whatsapp_margins_diff_h1b)) {
  whatsapp_margins_diff_h1b_delta[i, "at"] <- names(whatsapp_margins_diff_h1b[i])
  whatsapp_margins_diff_h1b_delta[i, "delta"] <- whatsapp_margins_diff_h1b[[i]][["Margin"]][2]
  whatsapp_margins_diff_h1b_delta[i, "se"] <- whatsapp_margins_diff_h1b[[i]][["Standard.Error"]][2]
}

whatsapp_margins_diff_h1b_delta %<>%
  mutate(at = gsub("immigrant_attitudes_factor = ", "", at)) %>%
  mutate(at = as.numeric(at)) %>%
  mutate(conf_low = delta - se) %>%
  mutate(conf_high = delta + se)

### Plot differences

## Attitude dimension as new data frame

whatsapp_attitude_df = data.frame(attitude = data_2$immigrant_attitudes_factor[!is.na(data_2$share_report_2_whatsapp)],
                               y = 0)

## Plot

whatsapp_h1b_marginsplot <- h1a_marginsplot(whatsapp_margins_diff_h1b_delta,
                                            x_lab = "Migration attitude factor", 
                                           x_lim_low = -2, x_lim_high = 2.2,
                                           rug_data = whatsapp_attitude_df,
                                           y_lim_low = -0.5, y_lim_high = 0.5)

#### Combine plots ####

ggarrange(email_h1b_marginsplot, 
         fb_h1b_marginsplot,
         twitter_h1b_marginsplot, 
         whatsapp_h1b_marginsplot,
         labels = c("Email", "Facebook", 
                    "Twitter", "Whatsapp"),
         ncol = 2, nrow = 2, 
         common.legend = TRUE,
         font.label = list(size = 12),
         legend = "bottom")

```

\newpage

# Differences Twitter users and non-users (Study 2)

Table \@ref(tab:demographics-twitter) allows to examine whether different effects on Twitter sharing might be due to sample differences. Significant differences between users and non-users show only for age, gender and turnout intention. Table \@ref(tab:study2-robust1-twitterusers) presents analyses for the three other sharing outcomes with the subset of Twitter users only and shows that results are indeed similar for sharing via email (also illustrated by \@ref{fig:fig-h4b-email-twitterer}). 

```{r demographics-twitter, paged.print=FALSE, eval = T}

### Dummy for Twitter users

data_2 %<>% mutate(twitter_user = ifelse(account_twitter == "Ja", 1, 0))

### Create data frame

twitter_demographics <- data.frame(variable = NA, nonusers = NA, users = NA, pvalue = NA)

## Sex

twitter_demographics[1, "variable"] <- "Gender (proportion female)"
twitter_demographics[1, "nonusers"] <- 
  round(mean(data_2$gender[data_2$twitter_user == 0]), 2)
twitter_demographics[1, "users"] <- 
  round(mean(data_2$gender[data_2$twitter_user == 1]), 2)
twitter_demographics[1, "pvalue"] <- 
  format(round(t.test(age ~ twitter_user, data = data_2)[["p.value"]], 2), nsmall = 2)

## Age

twitter_demographics[2, "variable"] <- "Age (mean)"
twitter_demographics[2, "nonusers"] <- 
  round(mean(data_2$age[data_2$twitter_user == 0]), 2)
twitter_demographics[2, "users"] <- 
  round(mean(data_2$age[data_2$twitter_user == 1]), 2)
twitter_demographics[2, "pvalue"] <- 
  format(round(t.test(gender ~ twitter_user, data = data_2)[["p.value"]], 2), nsmall = 2)

## Education

twitter_demographics[3, c("variable", "nonusers", "users", "pvalue")] <- 
  c("Education", "", "", "")
twitter_demographics[4:9, "variable"] <- levels(data_2$education_6)
twitter_demographics[4:9, "nonusers"] <- 
  round(prop.table(table(data_2$education_6[data_2$twitter_user == 0])), 2)
twitter_demographics[4:9, "users"] <- 
  round(prop.table(table(data_2$education_6[data_2$twitter_user == 1])), 2)
twitter_demographics[3, "pvalue"] <- 
  format(round(chisq.test(table(data_2$education_6[data_2$twitter_user == 0]),
                   table(data_2$education_6[data_2$twitter_user == 1]))[["p.value"]], 2),
         nsmall = 2)
twitter_demographics[4:9, "pvalue"] <- ""

## East vs. West

twitter_demographics[10, "variable"] <- "West Germany resident (proportion)"
twitter_demographics[10, "nonusers"] <- 
  round(mean(data_2$federal_state_west[data_2$twitter_user == 0]), 2)
twitter_demographics[10, "users"] <- 
  round(mean(data_2$federal_state_west[data_2$twitter_user == 1]), 2)
twitter_demographics[10, "pvalue"] <- 
  format(round(t.test(federal_state_west ~ twitter_user, data = data_2)[["p.value"]], 2),
         nsmall = 2)

## Turnout

twitter_demographics[11, "variable"] <- "Turnout (proportion turned out)"
twitter_demographics[11, "nonusers"] <- 
  round(mean(data_2$turnout_binary[data_2$twitter_user == 0], na.rm = TRUE), 2)
twitter_demographics[11, "users"] <- 
  round(mean(data_2$turnout_binary[data_2$twitter_user == 1], na.rm = TRUE), 2)
twitter_demographics[11, "pvalue"] <- 
  format(round(t.test(turnout_binary ~ twitter_user, data = data_2)[["p.value"]], 2),
         nsmall = 2)

## Vote choice

twitter_demographics[12, c("variable", "nonusers", "users", "pvalue")] <- 
  c("Vote choice", "", "", "")
twitter_demographics[13:19, "variable"] <- levels(data_2$vote_choice_6)
twitter_demographics[13:19, "nonusers"] <- 
  round(prop.table(table(data_2$vote_choice_6[data_2$twitter_user == 0])), 2)
twitter_demographics[13:19, "users"] <- 
  round(prop.table(table(data_2$vote_choice_6[data_2$twitter_user == 1])), 2)
twitter_demographics[12, "pvalue"] <- 
  format(round(chisq.test(table(data_2$vote_choice_6[data_2$twitter_user == 0]),
                   table(data_2$vote_choice_6[data_2$twitter_user == 1]))[["p.value"]], 2),
         nsmall = 2)
twitter_demographics[13:19, "pvalue"] <- ""

## Political knowledge

twitter_demographics[20, "variable"] <- "Political knowledge (mean)"
twitter_demographics[20, "nonusers"] <- 
  round(mean(data_2$knowpol_total[data_2$twitter_user == 0], na.rm = TRUE), 2)
twitter_demographics[20, "users"] <- 
  round(mean(data_2$knowpol_total[data_2$twitter_user == 1], na.rm = TRUE), 2)
twitter_demographics[20, "pvalue"] <- 
  format(round(t.test(knowpol_total ~ twitter_user, data = data_2)[["p.value"]], 2),
         nsmall = 2)

## Overconfidence

twitter_demographics[21, "variable"] <- "Overconfidence (mean)"
twitter_demographics[21, "nonusers"] <- 
  round(mean(data_2$overconfidence[data_2$twitter_user == 0], na.rm = TRUE), 2)
twitter_demographics[21, "users"] <- 
  round(mean(data_2$overconfidence[data_2$twitter_user == 1], na.rm = TRUE), 2)
twitter_demographics[21, "pvalue"] <- 
  format(round(t.test(overconfidence ~ twitter_user, data = data_2)[["p.value"]], 2),
         nsmall = 2)

## Media trust

twitter_demographics[22, "variable"] <- "Media trust index (mean)"
twitter_demographics[22, "nonusers"] <- 
  round(mean(data_2$trustsource_mainstream[data_2$twitter_user == 0], na.rm = TRUE), 2)
twitter_demographics[22, "users"] <- 
  round(mean(data_2$trustsource_mainstream[data_2$twitter_user == 1], na.rm = TRUE), 2)
twitter_demographics[22, "pvalue"] <- 
  format(round(t.test(trustsource_mainstream ~ twitter_user, data = data_2)[["p.value"]], 2), 
         nsmall = 2)

### Table

twitter_demographics %<>% 
  mutate(variable = 
           cell_spec(variable, "latex", 
                     italic = ifelse(variable == "None or still in school" |
                                       variable == "Lower school (Volks-/Hauptschule)" |
                                       variable == "Middle school (Realschule)" |
                                       variable == "Technical high school (Fachabitur)" |
                                       variable == "High school (Abitur)" |
                                       variable == "University" |
                                       variable == "Die Linke" |
                                       variable == "SPD" |
                                       variable == "Buendnis 90/Die Gruenen" |
                                       variable == "FDP" |
                                       variable == "CDU/CSU" |
                                       variable == "AfD" |
                                       variable == "No vote/other party", T, F))) %>%
  mutate(pvalue =
           cell_spec(pvalue, "latex", bold = ifelse(pvalue < 0.05, T, F)))

colnames(twitter_demographics)[1] <- "Variable"
colnames(twitter_demographics)[2] <- "Non-users"
colnames(twitter_demographics)[3] <- "Users"
colnames(twitter_demographics)[4] <- paste0("Significance", footnote_marker_alphabet(1))

kable(twitter_demographics, 
      caption = "Demographics of Twitter users and non-users", 
      format = "latex", booktabs = T, linesep = "", longtable = T, escape = F) %>%
  kable_styling(full_width = T,
                latex_options = c("scale_down", "HOLD_position"),
                font_size = 10) %>%
  column_spec(1, width = "5.5cm") %>%
  add_indent(c(4, 5, 6, 7, 8, 9, 13, 14, 15, 16, 17, 18, 19)) %>%
  footnote(alphabet = c("p-value of t-test for proportions and means; p-value of chi2-test for categorical variables. Differences significant at 5%-level in bold."), threeparttable = T)

```

```{r study2-robust1-twitterusers, echo = FALSE, results = "asis", paged.print = FALSE}

study2_robust1 <- list()

#### Subset of Twitter users ####

data_2_twitterer <- data_2 %>% filter(!is.na(share_report_2_twitter))

#### Email ####

study2_robust1$email_h1b <- glm(share_report_2_email ~ 
                             treatment_content*immigrant_attitudes_factor, 
                           data = data_2_twitterer, family = "binomial")
study2_robust1$email_h2b <- glm(share_report_2_email ~ 
                             treatment_source,
                           data = data_2, family = "binomial")
study2_robust1$email_h3b <- glm(share_report_2_email ~ 
                             treatment_source*trustsource_mainstream,
                           data = data_2_twitterer, family = "binomial")
study2_robust1$email_h4b <- glm(share_report_2_email ~ 
                          treatment_content*immigrant_attitudes_factor*treatment_source,
                          data = data_2_twitterer, family = "binomial")

#### FB ####

study2_robust1$fb_h1b <- glm(share_report_2_fb ~ 
                  treatment_content*immigrant_attitudes_factor, 
                data = data_2_twitterer, family = "binomial")
study2_robust1$fb_h2b<- glm(share_report_2_fb ~ 
                  treatment_source,
                data = data_2_twitterer, family = "binomial")
study2_robust1$fb_h3b <- glm(share_report_2_fb ~ 
                  treatment_source*trustsource_mainstream,
                data = data_2_twitterer, family = "binomial")
study2_robust1$fb_h4b <- glm(share_report_2_fb ~ 
                  treatment_content*immigrant_attitudes_factor*treatment_source,
                data = data_2_twitterer, family = "binomial")

#### Whatsapp ####

study2_robust1$whatsapp_h1b <- glm(share_report_2_whatsapp ~ 
                  treatment_content*immigrant_attitudes_factor, 
                data = data_2_twitterer, family = "binomial")
study2_robust1$whatsapp_h2b <- glm(share_report_2_whatsapp ~ 
                  treatment_source,
                data = data_2_twitterer, family = "binomial")
study2_robust1$whatsapp_h3b  <- glm(share_report_2_whatsapp ~ 
                  treatment_source*trustsource_mainstream,
                data = data_2_twitterer, family = "binomial")
study2_robust1$whatsapp_h4b  <- glm(share_report_2_whatsapp ~ 
                  treatment_content*immigrant_attitudes_factor*treatment_source,
                data = data_2_twitterer, family = "binomial")

#### Rename coefficients for table ####

models_h1b <- c("email_h1b", "fb_h1b", "whatsapp_h1b")
for(i in models_h1b) {
  names(study2_robust1[[i]]$coefficients) <- c("Constant",
                                       "Report (0 = left-wing)",
                                       "Attitude",
                                       "Report * Attitude")
}

models_h2b <- c("email_h2b", "fb_h2b", "whatsapp_h2b")
for(i in models_h2b) {
  names(study2_robust1[[i]]$coefficients) <- c("Constant",
                                       "Source (0 = unknown)")
}

models_h3b <- c("email_h3b", "fb_h3b", "whatsapp_h3b")
for(i in models_h3b) {
  names(study2_robust1[[i]]$coefficients) <- c("Constant",
                                       "Source (0 = unknown)",
                                       "Trust",
                                       "Source * Trust")
}

models_h4b <- c("email_h4b", "fb_h4b", "whatsapp_h4b")
for(i in models_h4b) {
  names(study2_robust1[[i]]$coefficients) <- c("Constant",
                                       "Report (0 = left-wing)",
                                       "Attitude",
                                       "Source (0 = unknown)",
                                       "Report * Attitude",
                                       "Report * Source",
                                       "Attitude * Source",
                                       "Report * Attitude * Source")
}

#### Table for all topics ####

stargazer(study2_robust1$email_h1b, study2_robust1$email_h2b, 
          study2_robust1$email_h3b, study2_robust1$email_h4b,
          study2_robust1$fb_h1b, study2_robust1$fb_h2b, 
          study2_robust1$fb_h3b, study2_robust1$fb_h4b,
          study2_robust1$whatsapp_h1b, study2_robust1$whatsapp_h2b, 
          study2_robust1$whatsapp_h3b, study2_robust1$whatsapp_h4b,
          type = "latex",
          out = "./table-4.tex",
          table.placement = "!ht",
          omit.stat = c("LL","ser","f","adj.rsq"),
          label = "tab:study2-robust1", 
          single.row = FALSE,
          no.space = FALSE,
          digits = 2,
          align = TRUE,
          font.size = "scriptsize",
          column.sep.width = "-16pt",
          star.cutoffs = c(0.1, 0.05, 0.01),
          covariate.labels = c("Report (0 = left-wing)",
                               "Attitude",
                               "Report * Attitude",
                               "Source (0 = unknown)",
                               "Trust",
                               "Source * Trust",
                               "Report * Source",
                               "Attitude * Source",
                               "Report * Attitude * Source",
                               "Constant"),
          order = c(2, 3, 4, 8, 9, 10, 5, 6, 7, 1),
          model.names = FALSE, 
          model.numbers = FALSE,
          title = "Sharing tendency for Twitter users only",
          dep.var.caption = "",
          column.labels = c("H1a", "H2a", "H3a", "H4a",
                            "H1a", "H2a", "H3a", "H4a",
                            "H1a", "H2a", "H3a", "H4a"),
          dep.var.labels = c("Email", "Facebook", "Whatsapp"),
          header = FALSE)


```

```{r study2-margins-h4b-email-twitterer, fig.cap = "Source-congruence interaction for Email sharing by Twitter users\\label{fig:fig-h4b-email-twitterer}", fig.height = 3.5, out.extra = '', fig.pos= "h"}

#### Email ####

immigrant_05_email <- data_2 %>% 
  filter(!is.na(share_report_2_email)) %>%
  summarize(quants = quantile(immigrant_attitudes_factor, probs = 0.05))
immigrant_05_email <- as.vector(immigrant_05_email[[1]])

immigrant_95_email <- data_2 %>% 
  filter(!is.na(share_report_2_email)) %>%
  summarize(quants =  quantile(immigrant_attitudes_factor, probs = 0.95))
immigrant_95_email <- as.vector(immigrant_95_email[[1]])

email_margins_h4b_points <- 
  marg(study2$email_h4b,
       var_interest = "treatment_content",
       at = list("immigrant_attitudes_factor" = c(immigrant_05_email,
                                                  immigrant_95_email),
                 "treatment_source" = c(0, 1)))

## Point estimates

email_margins_h4b_points_df <- data.frame(content = rep(c(0,1), 4),
                                            attitude = rep(c(immigrant_05_email,
                                                             immigrant_05_email,
                                                             immigrant_95_email,
                                                             immigrant_95_email), 2), 
                                            source = c(0, 0, 0, 0, 1, 1, 1, 1),
                                            share_report_2_email = NA, se = NA)

for (i in 1:length(email_margins_h4b_points)) {
  email_margins_h4b_points_df[i*2 - 1, "share_report_2_email"] <-
    email_margins_h4b_points[[i]][["Margin"]][1]
  email_margins_h4b_points_df[i*2 - 1, "se"] <-
    email_margins_h4b_points[[i]][["Standard.Error"]][1]
  email_margins_h4b_points_df[i*2, "share_report_2_email"] <-
    email_margins_h4b_points[[i]][["Margin"]][2]
  email_margins_h4b_points_df[i*2, "se"] <-
    email_margins_h4b_points[[i]][["Standard.Error"]][2]
}

email_margins_h4b_points_df %<>% 
  mutate(source = as.factor(source)) %>%
  mutate(content = as.factor(content)) %>%
  mutate(conf_low = share_report_2_email + se) %>%
  mutate(conf_high = share_report_2_email - se)

## Attitude data frame for rug plot

email_attitude_df <- data_2 %>% 
  filter(!is.na(share_report_2_email)) %>%
  select(immigrant_attitudes_factor) %>%
  mutate(y = 0)

## Plot

ggplot(email_margins_h4b_points_df, 
       aes(x = attitude, 
           y = share_report_2_email,
           interaction(content, source), 
           linetype = content,
           shape = source)) +
  geom_point() +
  geom_path() +
  labs(y = "Email sharing tendency", 
       x = "Immigration attitude (factor)",
       linetype = "Content treatment",
       shape = "Source treatment") + 
  scale_y_continuous(breaks = c(0, 0.25, 0.5, 0.75, 1), 
                     limits = c(0, 1)) +
  xlim(-2.5, 2.2) +
  theme(
    panel.border = element_rect(colour = "#DCDCDC", fill = NA, size =1.5),
    panel.background = element_blank(), 
    panel.grid.major = element_line(size=.5, color = "#EEEEEE"),
    legend.key = element_blank()) +
  scale_linetype_discrete(labels = c("Anti-migration news report", 
                                     "Pro-migration news report")) +
  scale_shape_discrete(labels = c("Unknown", "Known")) + 
  geom_rug(inherit.aes = FALSE, 
           aes(x = immigrant_attitudes_factor, y = y),
           data = email_attitude_df, 
           sides="b", alpha = 0.1, size = 1.2, position = "jitter")

```

\clearpage

# Robustness checks

## Study 1 

When re-running analyses for the welfare state topic with different attitude items, the congruence interaction remains significant for all but one item (Table \@ref(tab:study1-robust1-welfare)). Table \@ref(tab:study1-robust2-cheaters) shows that results for all topics remain unchanged when cheaters are excluded from the sample. Table \@ref(tab:study1-robust3-fbusers) reveals that when exluding those not using Facebook the congruence interaction, while substantially unchanged, becomes statistically insignificant for the report on European integration. This might be due to a sample reduced by about a third. 

```{r study1-robust1-welfare, results = "asis", paged.print = FALSE}

study1_robust1 <- list()

#### Topic 1 ####

### Main model: Attitude 2

study1_robust1$topic1_h1a_att2 <- glm(topic1_belief_stand ~ 
                                   topic1_content*topic1_attitude2_stand, 
                                 data = data_1)

study1_robust1$topic1_h4a_att2 <- glm(topic1_belief_stand ~ 
                                   topic1_content*topic1_attitude2_stand*topic1_source, 
                                 data = data_1)

### Alternative model: Attitude 1

study1_robust1$topic1_h1a_att1 <- glm(topic1_belief_stand ~ 
                    topic1_content*topic1_attitude1_stand, data = data_1)

study1_robust1$topic1_h4a_att1 <- glm(topic1_belief_stand ~ 
                  topic1_content*topic1_attitude1_stand*topic1_source, data = data_1)

### Alternative model: Attitude 3

study1_robust1$topic1_h1a_att3 <- glm(topic1_belief_stand ~ 
                    topic1_content*topic1_attitude3_stand, data = data_1)

study1_robust1$topic1_h4a_att3 <- glm(topic1_belief_stand ~ 
                  topic1_content*topic1_attitude3_stand*topic1_source, data = data_1)

### Alternative model: Attitude 4

study1_robust1$topic1_h1a_att4 <- glm(topic1_belief_stand ~ 
                    topic1_content*topic1_attitude4_stand, data = data_1)

study1_robust1$topic1_h4a_att4 <- glm(topic1_belief_stand ~ 
                  topic1_content*topic1_attitude4_stand*topic1_source, data = data_1)

### Rename coefficients for table

models_h1a_robust1 <- paste0("topic1_h1a_att", 1:4)
for(i in models_h1a_robust1) {
  names(study1_robust1[[i]]$coefficients) <- c("Constant",
                                               "Report (0 = left-wing)",
                                               "Attitude",
                                               "Report * Attitude")
}

models_h4a_robust1 <- paste0("topic1_h4a_att", 1:4)
for(i in models_h4a_robust1) {
  names(study1_robust1[[i]]$coefficients) <- c("Constant",
                                       "Report (0 = left-wing)",
                                       "Attitude",
                                       "Source (0 = unknown)",
                                       "Report * Attitude",
                                       "Report * Source",
                                       "Attitude * Source",
                                       "Report * Attitude * Source")
}

### Table

stargazer(study1_robust1$topic1_h1a_att2, study1_robust1$topic1_h4a_att2,
          study1_robust1$topic1_h1a_att1, study1_robust1$topic1_h4a_att1,
          study1_robust1$topic1_h1a_att3, study1_robust1$topic1_h4a_att3,
          study1_robust1$topic1_h1a_att4, study1_robust1$topic1_h4a_att4,
          type = "latex",
          out = "./table-4.tex",
          table.placement = "!ht",
          omit.stat = c("LL","ser","f","adj.rsq"),
          single.row = FALSE,
          no.space = FALSE,
          digits = 2,
          align = TRUE,
          font.size = "scriptsize",
          column.sep.width = "-10pt",
          star.cutoffs = c(0.1, 0.05, 0.01),
          covariate.labels = c("Report (0 = left-wing)",
                               "Attitude",
                               "Report * Attitude",
                               "Source (0 = unknown)",
                               "Report * Source",
                               "Attitude * Source",
                               "Report * Attitude * Source",
                               "Constant"),
          order = c(2, 3, 5, 4, 6, 7, 8, 1),
          model.names = FALSE, 
          model.numbers = FALSE,
          title = "Beliefs for alternative welfare state attitudes",
          label = "tab:study1-robust1-welfare", 
          dep.var.caption = "",
          column.labels   = c("Attitude 2 (main model)", "Attitude 1",
                             "Attitude 3", "Attitude 4"),
          column.separate = c(2, 2, 2, 2),
          dep.var.labels = c("Specifications"),
          header = FALSE)

```

\blandscape 

```{r study1-robust2-cheaters, results = "asis", paged.print = FALSE}

#### Exclude cheating suspects ####

data_1_nocheaters <- data_1 %>% 
  filter(!(truestory_belief == 10 & truestory_belief_submit > 15))

# Content treatment: 0 is left-wing congruent content, 1 is right-wing congruent content
# Attitude: low is left-wing, high is right-wing

study1_robust2 <- list()

#### Topic 1 ####

### Main models: Attitude 2

study1_robust2$topic1_h1a <- glm(topic1_belief_stand ~ 
                                      topic1_content*topic1_attitude2_stand, 
                                    data = data_1_nocheaters)

study1_robust2$topic1_h2a <- glm(topic1_belief_stand ~ 
                                      topic1_source, data = data_1_nocheaters)

study1_robust2$topic1_h3a <- glm(topic1_belief_stand ~ 
                                      topic1_source*trustsource_mainstream, 
                                    data = data_1_nocheaters)

study1_robust2$topic1_h4a <- glm(topic1_belief_stand ~ 
                                      topic1_content*topic1_attitude2_stand*topic1_source, 
                                    data = data_1_nocheaters)

#### Topic 2 ####

study1_robust2$topic2_h1a <- glm(topic2_belief_stand ~ 
                                      topic2_content*topic2_attitudes_factor, 
                                    data = data_1_nocheaters)

study1_robust2$topic2_h2a <- glm(topic2_belief_stand ~ 
                                      topic2_source, 
                                    data = data_1_nocheaters)

study1_robust2$topic2_h3a <- glm(topic2_belief_stand ~ 
                                      topic2_source*trustsource_mainstream, 
                                    data = data_1_nocheaters)

study1_robust2$topic2_h4a <- glm(topic2_belief_stand ~ 
                                      topic2_content*topic2_attitudes_factor*topic2_source, 
                                    data = data_1_nocheaters)

#### Topic 3 ####

study1_robust2$topic3_h1a <- glm(topic3_belief_stand ~ 
                                      topic3_content*topic3_attitudes_factor, 
                                    data = data_1_nocheaters)

study1_robust2$topic3_h2a <- glm(topic3_belief_stand ~ 
                                      topic3_source, 
                                    data = data_1_nocheaters)

study1_robust2$topic3_h3a <- glm(topic3_belief_stand ~ 
                                      topic3_source*trustsource_mainstream, 
                                    data = data_1_nocheaters)

study1_robust2$topic3_h4a <- glm(topic3_belief_stand ~ 
                                      topic3_content*topic3_attitudes_factor*topic3_source, 
                                    data = data_1_nocheaters)

#### Topic 4 ####

study1_robust2$topic4_h1a <- glm(topic4_belief_stand ~ 
                                      topic4_content*topic4_attitudes_factor, 
                                    data = data_1_nocheaters)

study1_robust2$topic4_h2a <- glm(topic4_belief_stand ~ 
                                      topic4_source, 
                                    data = data_1_nocheaters)

study1_robust2$topic4_h3a <- glm(topic4_belief_stand ~ 
                                      topic4_source*trustsource_mainstream, 
                                    data = data_1_nocheaters)

study1_robust2$topic4_h4a <- glm(topic4_belief_stand ~ 
                                      topic4_content*topic4_attitudes_factor*topic4_source, 
                                    data = data_1_nocheaters)

#### Rename coefficients for table ###

models_h1a <- paste0("topic", 1:4, "_h1a")
for(i in models_h1a) {
  names(study1_robust2[[i]]$coefficients) <- c("Constant",
                                                  "Report (0 = left-wing)",
                                                         "Attitude",
                                                         "Report * Attitude")
}

models_h2a <- paste0("topic", 1:4, "_h2a")
for(i in models_h2a) {
  names(study1_robust2[[i]]$coefficients) <- c("Constant",
                                                         "Source (0 = unknown)")
}

models_h3a <- paste0("topic", 1:4, "_h3a")
for(i in models_h3a) {
  names(study1_robust2[[i]]$coefficients) <- c("Constant",
                                                         "Source (0 = unknown)",
                                                         "Trust",
                                                         "Source * Trust")
}

models_h4a <- paste0("topic", 1:4, "_h4a")
for(i in models_h4a) {
  names(study1_robust2[[i]]$coefficients) <- c("Constant",
                                                         "Report (0 = left-wing)",
                                                         "Attitude",
                                                         "Source (0 = unknown)",
                                                         "Report * Attitude",
                                                         "Report * Source",
                                                         "Attitude * Source",
                                                         "Report * Attitude * Source")
}

#### Table for all topics ####

dep_vars = c("Welfare State", "Domestic Security","Migration", "European integration")

full_models_table(study1_robust2, "tab:study1-robust2-cheaters", 
                  "Belief without cheating suspects", dep_vars)

```

```{r study1-robust3-fbusers, results = "asis", paged.print = FALSE}

#### Exclude cheating suspects ####

data_1_fbusers <- data_1 %>% 
  filter(fb_account == "Ja")

# Content treatment: 0 is left-wing congruent content, 1 is right-wing congruent content
# Attitude: low is left-wing, high is right-wing

study1_robust3 <- list()

#### Topic 1 ####

### Main models: Attitude 2


study1_robust3$topic1_h1a <- glm(topic1_belief_stand ~ 
                                      topic1_content*topic1_attitude2_stand, 
                                    data = data_1_fbusers)

study1_robust3$topic1_h2a <- glm(topic1_belief_stand ~ 
                                      topic1_source, data = data_1_fbusers)

study1_robust3$topic1_h3a <- glm(topic1_belief_stand ~ 
                                      topic1_source*trustsource_mainstream, 
                                    data = data_1_fbusers)

study1_robust3$topic1_h4a <- glm(topic1_belief_stand ~ 
                                      topic1_content*topic1_attitude2_stand*topic1_source, 
                                    data = data_1_fbusers)

#### Topic 2 ####

study1_robust3$topic2_h1a <- glm(topic2_belief_stand ~ 
                                      topic2_content*topic2_attitudes_factor, 
                                    data = data_1_fbusers)

study1_robust3$topic2_h2a <- glm(topic2_belief_stand ~ 
                                      topic2_source, 
                                    data = data_1_fbusers)

study1_robust3$topic2_h3a <- glm(topic2_belief_stand ~ 
                                      topic2_source*trustsource_mainstream, 
                                    data = data_1_fbusers)

study1_robust3$topic2_h4a <- glm(topic2_belief_stand ~ 
                                      topic2_content*topic2_attitudes_factor*topic2_source, 
                                    data = data_1_fbusers)

#### Topic 3 ####

study1_robust3$topic3_h1a <- glm(topic3_belief_stand ~ 
                                      topic3_content*topic3_attitudes_factor, 
                                    data = data_1_fbusers)

study1_robust3$topic3_h2a <- glm(topic3_belief_stand ~ 
                                      topic3_source, 
                                    data = data_1_fbusers)

study1_robust3$topic3_h3a <- glm(topic3_belief_stand ~ 
                                      topic3_source*trustsource_mainstream, 
                                    data = data_1_fbusers)

study1_robust3$topic3_h4a <- glm(topic3_belief_stand ~ 
                                      topic3_content*topic3_attitudes_factor*topic3_source, 
                                    data = data_1_fbusers)

#### Topic 4 ####

study1_robust3$topic4_h1a <- glm(topic4_belief_stand ~ 
                                      topic4_content*topic4_attitudes_factor, 
                                    data = data_1_fbusers)

study1_robust3$topic4_h2a <- glm(topic4_belief_stand ~ 
                                      topic4_source, 
                                    data = data_1_fbusers)

study1_robust3$topic4_h3a <- glm(topic4_belief_stand ~ 
                                      topic4_source*trustsource_mainstream, 
                                    data = data_1_fbusers)

study1_robust3$topic4_h4a <- glm(topic4_belief_stand ~ 
                                      topic4_content*topic4_attitudes_factor*topic4_source, 
                                    data = data_1_fbusers)

#### Rename coefficients for table ###

models_h1a <- paste0("topic", 1:4, "_h1a")
for(i in models_h1a) {
  names(study1_robust3[[i]]$coefficients) <- c("Constant",
                                                  "Report (0 = left-wing)",
                                                         "Attitude",
                                                         "Report * Attitude")
}

models_h2a <- paste0("topic", 1:4, "_h2a")
for(i in models_h2a) {
  names(study1_robust3[[i]]$coefficients) <- c("Constant",
                                                         "Source (0 = unknown)")
}

models_h3a <- paste0("topic", 1:4, "_h3a")
for(i in models_h3a) {
  names(study1_robust3[[i]]$coefficients) <- c("Constant",
                                                         "Source (0 = unknown)",
                                                         "Trust",
                                                         "Source * Trust")
}

models_h4a <- paste0("topic", 1:4, "_h4a")
for(i in models_h4a) {
  names(study1_robust3[[i]]$coefficients) <- c("Constant",
                                                         "Report (0 = left-wing)",
                                                         "Attitude",
                                                         "Source (0 = unknown)",
                                                         "Report * Attitude",
                                                         "Report * Source",
                                                         "Attitude * Source",
                                                         "Report * Attitude * Source")
}

#### Table for all topics ####

dep_vars = c("Welfare State", "Domestic Security","Migration", "European integration")

full_models_table(study1_robust3, "tab:study1-robust3-fbusers", 
                  "Belief for Facebook users only", dep_vars)

```

\elandscape 

## Study 2

Table \@ref(tab:study2-robust2) shows results for the subsample of respondents that did not leave the online questionnaire when reading the report, Table \@ref(tab:study2-robust3) for those who passed the content manipulation check, Table \@ref(tab:study2-robust4) for those who passed the source manipulation check. In all three cases, the source-congruence interaction for Twitter gets insignificant, although this might be due to the reduced sample sizes. For the subsample of frequent sharers (Table \@ref(tab:study2-robust5)), the source effect for Email disappears, as well as the source trust effect for Twitter. For Facebook users (Table \@ref(tab:study2-robust6), the source effect for email disappears. 

\blandscape    

```{r study2-robust1-treatment-fb, echo = FALSE, results = "asis", paged.print = FALSE}

study2_robust1 <- list()

#### Subset of focussed users ####

data_2_focussed <- data_2 %>% filter(treatment_channel == 0)

#### Email ####

study2_robust1$email_h1b <- glm(share_report_2_email ~ 
                             treatment_content*immigrant_attitudes_factor, 
                           data = data_2_focussed, family = "binomial")
study2_robust1$email_h2b <- glm(share_report_2_email ~ 
                             treatment_source,
                           data = data_2_focussed, family = "binomial")
study2_robust1$email_h3b <- glm(share_report_2_email ~ 
                             treatment_source*trustsource_mainstream,
                           data = data_2_focussed, family = "binomial")
study2_robust1$email_h4b <- glm(share_report_2_email ~ 
                          treatment_content*immigrant_attitudes_factor*treatment_source,
                          data = data_2_focussed, family = "binomial")

#### FB ####

study2_robust1$fb_h1b <- glm(share_report_2_fb ~ 
                  treatment_content*immigrant_attitudes_factor, 
                data = data_2_focussed, family = "binomial")
study2_robust1$fb_h2b<- glm(share_report_2_fb ~ 
                  treatment_source,
                data = data_2_focussed, family = "binomial")
study2_robust1$fb_h3b <- glm(share_report_2_fb ~ 
                  treatment_source*trustsource_mainstream,
                data = data_2_focussed, family = "binomial")
study2_robust1$fb_h4b <- glm(share_report_2_fb ~ 
                  treatment_content*immigrant_attitudes_factor*treatment_source,
                data = data_2_focussed, family = "binomial")

#### Twitter ####

study2_robust1$twitter_h1b <- glm(share_report_2_twitter ~ 
                  treatment_content*immigrant_attitudes_factor, 
                data = data_2_focussed, family = "binomial")
study2_robust1$twitter_h2b <- glm(share_report_2_twitter ~ 
                  treatment_source,
                data = data_2_focussed, family = "binomial")
study2_robust1$twitter_h3b  <- glm(share_report_2_twitter ~ 
                  treatment_source*trustsource_mainstream,
                data = data_2_focussed, family = "binomial")
study2_robust1$twitter_h4b  <- glm(share_report_2_twitter ~ 
                  treatment_content*immigrant_attitudes_factor*treatment_source,
                data = data_2_focussed, family = "binomial")

#### Whatsapp ####

study2_robust1$whatsapp_h1b <- glm(share_report_2_whatsapp ~ 
                  treatment_content*immigrant_attitudes_factor, 
                data = data_2_focussed, family = "binomial")
study2_robust1$whatsapp_h2b <- glm(share_report_2_whatsapp ~ 
                  treatment_source,
                data = data_2_focussed, family = "binomial")
study2_robust1$whatsapp_h3b  <- glm(share_report_2_whatsapp ~ 
                  treatment_source*trustsource_mainstream,
                data = data_2_focussed, family = "binomial")
study2_robust1$whatsapp_h4b  <- glm(share_report_2_whatsapp ~ 
                  treatment_content*immigrant_attitudes_factor*treatment_source,
                data = data_2_focussed, family = "binomial")

#### Rename coefficients for table ####

models_h1b <- c("email_h1b", "fb_h1b", "twitter_h1b", "whatsapp_h1b")
for(i in models_h1b) {
  names(study2_robust1[[i]]$coefficients) <- c("Constant",
                                       "Report (0 = left-wing)",
                                       "Attitude",
                                       "Report * Attitude")
}

models_h2b <- c("email_h2b", "fb_h2b", "twitter_h2b", "whatsapp_h2b")
for(i in models_h2b) {
  names(study2_robust1[[i]]$coefficients) <- c("Constant",
                                       "Source (0 = unknown)")
}

models_h3b <- c("email_h3b", "fb_h3b", "twitter_h3b", "whatsapp_h3b")
for(i in models_h3b) {
  names(study2_robust1[[i]]$coefficients) <- c("Constant",
                                       "Source (0 = unknown)",
                                       "Trust",
                                       "Source * Trust")
}

models_h4b <- c("email_h4b", "fb_h4b", "twitter_h4b", "whatsapp_h4b")
for(i in models_h4b) {
  names(study2_robust1[[i]]$coefficients) <- c("Constant",
                                       "Report (0 = left-wing)",
                                       "Attitude",
                                       "Source (0 = unknown)",
                                       "Report * Attitude",
                                       "Report * Source",
                                       "Attitude * Source",
                                       "Report * Attitude * Source")
}

#### Table for all topics ####

dep_vars = c("Email", "Facebook", "Twitter", "Whatsapp")

full_models_table(study2_robust1, "tab:study2-robust1", 
                  "Sharing tendency for those in Facebook treatment", dep_vars)

```

```{r study2-robust2-focussed, echo = FALSE, results = "asis", paged.print = FALSE}

study2_robust2 <- list()

#### Subset of focussed users ####

data_2_focussed <- data_2 %>% filter(is.na(report_2_focus_raw_loss))

#### Email ####

study2_robust2$email_h1b <- glm(share_report_2_email ~ 
                             treatment_content*immigrant_attitudes_factor, 
                           data = data_2_focussed, family = "binomial")
study2_robust2$email_h2b <- glm(share_report_2_email ~ 
                             treatment_source,
                           data = data_2_focussed, family = "binomial")
study2_robust2$email_h3b <- glm(share_report_2_email ~ 
                             treatment_source*trustsource_mainstream,
                           data = data_2_focussed, family = "binomial")
study2_robust2$email_h4b <- glm(share_report_2_email ~ 
                          treatment_content*immigrant_attitudes_factor*treatment_source,
                          data = data_2_focussed, family = "binomial")

#### FB ####

study2_robust2$fb_h1b <- glm(share_report_2_fb ~ 
                  treatment_content*immigrant_attitudes_factor, 
                data = data_2_focussed, family = "binomial")
study2_robust2$fb_h2b<- glm(share_report_2_fb ~ 
                  treatment_source,
                data = data_2_focussed, family = "binomial")
study2_robust2$fb_h3b <- glm(share_report_2_fb ~ 
                  treatment_source*trustsource_mainstream,
                data = data_2_focussed, family = "binomial")
study2_robust2$fb_h4b <- glm(share_report_2_fb ~ 
                  treatment_content*immigrant_attitudes_factor*treatment_source,
                data = data_2_focussed, family = "binomial")

#### Twitter ####

study2_robust2$twitter_h1b <- glm(share_report_2_twitter ~ 
                  treatment_content*immigrant_attitudes_factor, 
                data = data_2_focussed, family = "binomial")
study2_robust2$twitter_h2b <- glm(share_report_2_twitter ~ 
                  treatment_source,
                data = data_2_focussed, family = "binomial")
study2_robust2$twitter_h3b  <- glm(share_report_2_twitter ~ 
                  treatment_source*trustsource_mainstream,
                data = data_2_focussed, family = "binomial")
study2_robust2$twitter_h4b  <- glm(share_report_2_twitter ~ 
                  treatment_content*immigrant_attitudes_factor*treatment_source,
                data = data_2_focussed, family = "binomial")

#### Whatsapp ####

study2_robust2$whatsapp_h1b <- glm(share_report_2_whatsapp ~ 
                  treatment_content*immigrant_attitudes_factor, 
                data = data_2_focussed, family = "binomial")
study2_robust2$whatsapp_h2b <- glm(share_report_2_whatsapp ~ 
                  treatment_source,
                data = data_2_focussed, family = "binomial")
study2_robust2$whatsapp_h3b  <- glm(share_report_2_whatsapp ~ 
                  treatment_source*trustsource_mainstream,
                data = data_2_focussed, family = "binomial")
study2_robust2$whatsapp_h4b  <- glm(share_report_2_whatsapp ~ 
                  treatment_content*immigrant_attitudes_factor*treatment_source,
                data = data_2_focussed, family = "binomial")

#### Rename coefficients for table ####

models_h1b <- c("email_h1b", "fb_h1b", "twitter_h1b", "whatsapp_h1b")
for(i in models_h1b) {
  names(study2_robust2[[i]]$coefficients) <- c("Constant",
                                       "Report (0 = left-wing)",
                                       "Attitude",
                                       "Report * Attitude")
}

models_h2b <- c("email_h2b", "fb_h2b", "twitter_h2b", "whatsapp_h2b")
for(i in models_h2b) {
  names(study2_robust2[[i]]$coefficients) <- c("Constant",
                                       "Source (0 = unknown)")
}

models_h3b <- c("email_h3b", "fb_h3b", "twitter_h3b", "whatsapp_h3b")
for(i in models_h3b) {
  names(study2_robust2[[i]]$coefficients) <- c("Constant",
                                       "Source (0 = unknown)",
                                       "Trust",
                                       "Source * Trust")
}

models_h4b <- c("email_h4b", "fb_h4b", "twitter_h4b", "whatsapp_h4b")
for(i in models_h4b) {
  names(study2_robust2[[i]]$coefficients) <- c("Constant",
                                       "Report (0 = left-wing)",
                                       "Attitude",
                                       "Source (0 = unknown)",
                                       "Report * Attitude",
                                       "Report * Source",
                                       "Attitude * Source",
                                       "Report * Attitude * Source")
}

#### Table for all topics ####

full_models_table(study2_robust2, "tab:study2-robust2", 
                  "Sharing tendency for those focussed on report", dep_vars)

```

```{r study2-robust3-manipulation-content, echo = FALSE, results = "asis", paged.print = FALSE}

study2_robust3 <- list()

#### Subset of Twitter users ####

data_2_passed <- data_2 %>% filter(report_2_check_correct == 1)

#### Email ####

study2_robust3$email_h1b <- glm(share_report_2_email ~ 
                             treatment_content*immigrant_attitudes_factor, 
                           data = data_2_passed, family = "binomial")
study2_robust3$email_h2b <- glm(share_report_2_email ~ 
                             treatment_source,
                           data = data_2_passed, family = "binomial")
study2_robust3$email_h3b <- glm(share_report_2_email ~ 
                             treatment_source*trustsource_mainstream,
                           data = data_2_passed, family = "binomial")
study2_robust3$email_h4b <- glm(share_report_2_email ~ 
                          treatment_content*immigrant_attitudes_factor*treatment_source,
                          data = data_2_passed, family = "binomial")

#### FB ####

study2_robust3$fb_h1b <- glm(share_report_2_fb ~ 
                  treatment_content*immigrant_attitudes_factor, 
                data = data_2_passed, family = "binomial")
study2_robust3$fb_h2b<- glm(share_report_2_fb ~ 
                  treatment_source,
                data = data_2_passed, family = "binomial")
study2_robust3$fb_h3b <- glm(share_report_2_fb ~ 
                  treatment_source*trustsource_mainstream,
                data = data_2_passed, family = "binomial")
study2_robust3$fb_h4b <- glm(share_report_2_fb ~ 
                  treatment_content*immigrant_attitudes_factor*treatment_source,
                data = data_2_passed, family = "binomial")

#### Twitter ####

study2_robust3$twitter_h1b <- glm(share_report_2_twitter ~ 
                  treatment_content*immigrant_attitudes_factor, 
                data = data_2_passed, family = "binomial")
study2_robust3$twitter_h2b <- glm(share_report_2_twitter ~ 
                  treatment_source,
                data = data_2_passed, family = "binomial")
study2_robust3$twitter_h3b  <- glm(share_report_2_twitter ~ 
                  treatment_source*trustsource_mainstream,
                data = data_2_passed, family = "binomial")
study2_robust3$twitter_h4b  <- glm(share_report_2_twitter ~ 
                  treatment_content*immigrant_attitudes_factor*treatment_source,
                data = data_2_passed, family = "binomial")

#### Whatsapp ####

study2_robust3$whatsapp_h1b <- glm(share_report_2_whatsapp ~ 
                  treatment_content*immigrant_attitudes_factor, 
                data = data_2_passed, family = "binomial")
study2_robust3$whatsapp_h2b <- glm(share_report_2_whatsapp ~ 
                  treatment_source,
                data = data_2_passed, family = "binomial")
study2_robust3$whatsapp_h3b  <- glm(share_report_2_whatsapp ~ 
                  treatment_source*trustsource_mainstream,
                data = data_2_passed, family = "binomial")
study2_robust3$whatsapp_h4b  <- glm(share_report_2_whatsapp ~ 
                  treatment_content*immigrant_attitudes_factor*treatment_source,
                data = data_2_passed, family = "binomial")

#### Rename coefficients for table ####

models_h1b <- c("email_h1b", "fb_h1b", "twitter_h1b", "whatsapp_h1b")
for(i in models_h1b) {
  names(study2_robust3[[i]]$coefficients) <- c("Constant",
                                       "Report (0 = left-wing)",
                                       "Attitude",
                                       "Report * Attitude")
}

models_h2b <- c("email_h2b", "fb_h2b", "twitter_h2b", "whatsapp_h2b")
for(i in models_h2b) {
  names(study2_robust3[[i]]$coefficients) <- c("Constant",
                                       "Source (0 = unknown)")
}

models_h3b <- c("email_h3b", "fb_h3b", "twitter_h3b", "whatsapp_h3b")
for(i in models_h3b) {
  names(study2_robust3[[i]]$coefficients) <- c("Constant",
                                       "Source (0 = unknown)",
                                       "Trust",
                                       "Source * Trust")
}

models_h4b <- c("email_h4b", "fb_h4b", "twitter_h4b", "whatsapp_h4b")
for(i in models_h4b) {
  names(study2_robust3[[i]]$coefficients) <- c("Constant",
                                       "Report (0 = left-wing)",
                                       "Attitude",
                                       "Source (0 = unknown)",
                                       "Report * Attitude",
                                       "Report * Source",
                                       "Attitude * Source",
                                       "Report * Attitude * Source")
}

#### Table for all topics ####

full_models_table(study2_robust3, "tab:study2-robust3", 
                  "Sharing tendency for those who passed manipulation check (content)", dep_vars)

```

```{r study2-robust4-manipulation-source, echo = FALSE, results = "asis", paged.print = FALSE}

study2_robust4 <- list()

#### Subset of Twitter users ####

data_2_passed_source <- data_2 %>% filter(source_check_correct == 1)

#### Email ####

study2_robust4$email_h1b <- glm(share_report_2_email ~ 
                             treatment_content*immigrant_attitudes_factor, 
                           data = data_2_passed_source, family = "binomial")
study2_robust4$email_h2b <- glm(share_report_2_email ~ 
                             treatment_source,
                           data = data_2_passed_source, family = "binomial")
study2_robust4$email_h3b <- glm(share_report_2_email ~ 
                             treatment_source*trustsource_mainstream,
                           data = data_2_passed_source, family = "binomial")
study2_robust4$email_h4b <- glm(share_report_2_email ~ 
                          treatment_content*immigrant_attitudes_factor*treatment_source,
                          data = data_2_passed_source, family = "binomial")

#### FB ####

study2_robust4$fb_h1b <- glm(share_report_2_fb ~ 
                  treatment_content*immigrant_attitudes_factor, 
                data = data_2_passed_source, family = "binomial")
study2_robust4$fb_h2b<- glm(share_report_2_fb ~ 
                  treatment_source,
                data = data_2_passed_source, family = "binomial")
study2_robust4$fb_h3b <- glm(share_report_2_fb ~ 
                  treatment_source*trustsource_mainstream,
                data = data_2_passed_source, family = "binomial")
study2_robust4$fb_h4b <- glm(share_report_2_fb ~ 
                  treatment_content*immigrant_attitudes_factor*treatment_source,
                data = data_2_passed_source, family = "binomial")

#### Twitter ####

study2_robust4$twitter_h1b <- glm(share_report_2_twitter ~ 
                  treatment_content*immigrant_attitudes_factor, 
                data = data_2_passed_source, family = "binomial")
study2_robust4$twitter_h2b <- glm(share_report_2_twitter ~ 
                  treatment_source,
                data = data_2_passed_source, family = "binomial")
study2_robust4$twitter_h3b  <- glm(share_report_2_twitter ~ 
                  treatment_source*trustsource_mainstream,
                data = data_2_passed_source, family = "binomial")
study2_robust4$twitter_h4b  <- glm(share_report_2_twitter ~ 
                  treatment_content*immigrant_attitudes_factor*treatment_source,
                data = data_2_passed_source, family = "binomial")

#### Whatsapp ####

study2_robust4$whatsapp_h1b <- glm(share_report_2_whatsapp ~ 
                  treatment_content*immigrant_attitudes_factor, 
                data = data_2_passed_source, family = "binomial")
study2_robust4$whatsapp_h2b <- glm(share_report_2_whatsapp ~ 
                  treatment_source,
                data = data_2_passed_source, family = "binomial")
study2_robust4$whatsapp_h3b  <- glm(share_report_2_whatsapp ~ 
                  treatment_source*trustsource_mainstream,
                data = data_2_passed_source, family = "binomial")
study2_robust4$whatsapp_h4b  <- glm(share_report_2_whatsapp ~ 
                  treatment_content*immigrant_attitudes_factor*treatment_source,
                data = data_2_passed_source, family = "binomial")

#### Rename coefficients for table ####

models_h1b <- c("email_h1b", "fb_h1b", "twitter_h1b", "whatsapp_h1b")
for(i in models_h1b) {
  names(study2_robust4[[i]]$coefficients) <- c("Constant",
                                       "Report (0 = left-wing)",
                                       "Attitude",
                                       "Report * Attitude")
}

models_h2b <- c("email_h2b", "fb_h2b", "twitter_h2b", "whatsapp_h2b")
for(i in models_h2b) {
  names(study2_robust4[[i]]$coefficients) <- c("Constant",
                                       "Source (0 = unknown)")
}

models_h3b <- c("email_h3b", "fb_h3b", "twitter_h3b", "whatsapp_h3b")
for(i in models_h3b) {
  names(study2_robust4[[i]]$coefficients) <- c("Constant",
                                       "Source (0 = unknown)",
                                       "Trust",
                                       "Source * Trust")
}

models_h4b <- c("email_h4b", "fb_h4b", "twitter_h4b", "whatsapp_h4b")
for(i in models_h4b) {
  names(study2_robust4[[i]]$coefficients) <- c("Constant",
                                       "Report (0 = left-wing)",
                                       "Attitude",
                                       "Source (0 = unknown)",
                                       "Report * Attitude",
                                       "Report * Source",
                                       "Attitude * Source",
                                       "Report * Attitude * Source")
}

#### Table for all topics ####

full_models_table(study2_robust4, "tab:study2-robust4", 
                  "Sharing tendency for those who passed manipulation check (source)", dep_vars)

```

```{r study2-robust5-sharers, echo = FALSE, results = "asis", paged.print = FALSE}

study2_robust5 <- list()

#### Subset of Frequent sharers ####
# Defined as those sharing more often than "not at all"

data_2_email_sharers <- data_2 %>% filter(sharing_email > 1)
data_2_fb_sharers <- data_2 %>% filter(sharing_fb > 1)
data_2_whatsapp_sharers <- data_2 %>% filter(sharing_whatsapp > 1)
data_2_twitter_sharers <- data_2 %>% filter(sharing_twitter > 1)

#### Email ####

study2_robust5$email_h1b <- glm(share_report_2_email ~ 
                             treatment_content*immigrant_attitudes_factor, 
                           data = data_2_email_sharers, family = "binomial")
study2_robust5$email_h2b <- glm(share_report_2_email ~ 
                             treatment_source,
                           data = data_2_email_sharers, family = "binomial")
study2_robust5$email_h3b <- glm(share_report_2_email ~ 
                             treatment_source*trustsource_mainstream,
                           data = data_2_email_sharers, family = "binomial")
study2_robust5$email_h4b <- glm(share_report_2_email ~ 
                          treatment_content*immigrant_attitudes_factor*treatment_source,
                          data = data_2_email_sharers, family = "binomial")

#### FB ####

study2_robust5$fb_h1b <- glm(share_report_2_fb ~ 
                  treatment_content*immigrant_attitudes_factor, 
                data = data_2_fb_sharers, family = "binomial")
study2_robust5$fb_h2b<- glm(share_report_2_fb ~ 
                  treatment_source,
                data = data_2_fb_sharers, family = "binomial")
study2_robust5$fb_h3b <- glm(share_report_2_fb ~ 
                  treatment_source*trustsource_mainstream,
                data = data_2_fb_sharers, family = "binomial")
study2_robust5$fb_h4b <- glm(share_report_2_fb ~ 
                  treatment_content*immigrant_attitudes_factor*treatment_source,
                data = data_2_fb_sharers, family = "binomial")

#### Twitter ####

study2_robust5$twitter_h1b <- glm(share_report_2_twitter ~ 
                  treatment_content*immigrant_attitudes_factor, 
                data = data_2_twitter_sharers, family = "binomial")
study2_robust5$twitter_h2b <- glm(share_report_2_twitter ~ 
                  treatment_source,
                data = data_2_twitter_sharers, family = "binomial")
study2_robust5$twitter_h3b  <- glm(share_report_2_twitter ~ 
                  treatment_source*trustsource_mainstream,
                data = data_2_twitter_sharers, family = "binomial")
study2_robust5$twitter_h4b  <- glm(share_report_2_twitter ~ 
                  treatment_content*immigrant_attitudes_factor*treatment_source,
                data = data_2_twitter_sharers, family = "binomial")

#### Whatsapp ####

study2_robust5$whatsapp_h1b <- glm(share_report_2_whatsapp ~ 
                  treatment_content*immigrant_attitudes_factor, 
                data = data_2_whatsapp_sharers, family = "binomial")
study2_robust5$whatsapp_h2b <- glm(share_report_2_whatsapp ~ 
                  treatment_source,
                data = data_2_whatsapp_sharers, family = "binomial")
study2_robust5$whatsapp_h3b  <- glm(share_report_2_whatsapp ~ 
                  treatment_source*trustsource_mainstream,
                data = data_2_whatsapp_sharers, family = "binomial")
study2_robust5$whatsapp_h4b  <- glm(share_report_2_whatsapp ~ 
                  treatment_content*immigrant_attitudes_factor*treatment_source,
                data = data_2_whatsapp_sharers, family = "binomial")

#### Rename coefficients for table ####

models_h1b <- c("email_h1b", "fb_h1b", "twitter_h1b", "whatsapp_h1b")
for(i in models_h1b) {
  names(study2_robust5[[i]]$coefficients) <- c("Constant",
                                       "Report (0 = left-wing)",
                                       "Attitude",
                                       "Report * Attitude")
}

models_h2b <- c("email_h2b", "fb_h2b", "twitter_h2b", "whatsapp_h2b")
for(i in models_h2b) {
  names(study2_robust5[[i]]$coefficients) <- c("Constant",
                                       "Source (0 = unknown)")
}

models_h3b <- c("email_h3b", "fb_h3b", "twitter_h3b", "whatsapp_h3b")
for(i in models_h3b) {
  names(study2_robust5[[i]]$coefficients) <- c("Constant",
                                       "Source (0 = unknown)",
                                       "Trust",
                                       "Source * Trust")
}

models_h4b <- c("email_h4b", "fb_h4b", "twitter_h4b", "whatsapp_h4b")
for(i in models_h4b) {
  names(study2_robust5[[i]]$coefficients) <- c("Constant",
                                       "Report (0 = left-wing)",
                                       "Attitude",
                                       "Source (0 = unknown)",
                                       "Report * Attitude",
                                       "Report * Source",
                                       "Attitude * Source",
                                       "Report * Attitude * Source")
}

#### Table for all topics ####

full_models_table(study2_robust5, "tab:study2-robust5", 
                  "Sharing tendency for frequent sharers only", dep_vars)

```

```{r study2-robust6-fbusers, echo = FALSE, results = "asis", paged.print = FALSE}

study2_robust6 <- list()

#### Subset of Facebook users ####
# Defined as those sharing more often than "not at all"

data_2_fb_users <- data_2 %>% filter(account_fb == "Ja")

#### Email ####

study2_robust6$email_h1b <- glm(share_report_2_email ~ 
                             treatment_content*immigrant_attitudes_factor, 
                           data = data_2_fb_users, family = "binomial")
study2_robust6$email_h2b <- glm(share_report_2_email ~ 
                             treatment_source,
                           data = data_2_fb_users, family = "binomial")
study2_robust6$email_h3b <- glm(share_report_2_email ~ 
                             treatment_source*trustsource_mainstream,
                           data = data_2_fb_users, family = "binomial")
study2_robust6$email_h4b <- glm(share_report_2_email ~ 
                          treatment_content*immigrant_attitudes_factor*treatment_source,
                          data = data_2_fb_users, family = "binomial")

#### FB ####

study2_robust6$fb_h1b <- glm(share_report_2_fb ~ 
                  treatment_content*immigrant_attitudes_factor, 
                data = data_2_fb_users, family = "binomial")
study2_robust6$fb_h2b<- glm(share_report_2_fb ~ 
                  treatment_source,
                data = data_2_fb_users, family = "binomial")
study2_robust6$fb_h3b <- glm(share_report_2_fb ~ 
                  treatment_source*trustsource_mainstream,
                data = data_2_fb_users, family = "binomial")
study2_robust6$fb_h4b <- glm(share_report_2_fb ~ 
                  treatment_content*immigrant_attitudes_factor*treatment_source,
                data = data_2_fb_users, family = "binomial")

#### Twitter ####

study2_robust6$twitter_h1b <- glm(share_report_2_twitter ~ 
                  treatment_content*immigrant_attitudes_factor, 
                data = data_2_fb_users, family = "binomial")
study2_robust6$twitter_h2b <- glm(share_report_2_twitter ~ 
                  treatment_source,
                data = data_2_fb_users, family = "binomial")
study2_robust6$twitter_h3b  <- glm(share_report_2_twitter ~ 
                  treatment_source*trustsource_mainstream,
                data = data_2_fb_users, family = "binomial")
study2_robust6$twitter_h4b  <- glm(share_report_2_twitter ~ 
                  treatment_content*immigrant_attitudes_factor*treatment_source,
                data = data_2_fb_users, family = "binomial")

#### Whatsapp ####

study2_robust6$whatsapp_h1b <- glm(share_report_2_whatsapp ~ 
                  treatment_content*immigrant_attitudes_factor, 
                data = data_2_fb_users, family = "binomial")
study2_robust6$whatsapp_h2b <- glm(share_report_2_whatsapp ~ 
                  treatment_source,
                data = data_2_fb_users, family = "binomial")
study2_robust6$whatsapp_h3b  <- glm(share_report_2_whatsapp ~ 
                  treatment_source*trustsource_mainstream,
                data = data_2_fb_users, family = "binomial")
study2_robust6$whatsapp_h4b  <- glm(share_report_2_whatsapp ~ 
                  treatment_content*immigrant_attitudes_factor*treatment_source,
                data = data_2_fb_users, family = "binomial")

#### Rename coefficients for table ####

models_h1b <- c("email_h1b", "fb_h1b", "twitter_h1b", "whatsapp_h1b")
for(i in models_h1b) {
  names(study2_robust6[[i]]$coefficients) <- c("Constant",
                                       "Report (0 = left-wing)",
                                       "Attitude",
                                       "Report * Attitude")
}

models_h2b <- c("email_h2b", "fb_h2b", "twitter_h2b", "whatsapp_h2b")
for(i in models_h2b) {
  names(study2_robust6[[i]]$coefficients) <- c("Constant",
                                       "Source (0 = unknown)")
}

models_h3b <- c("email_h3b", "fb_h3b", "twitter_h3b", "whatsapp_h3b")
for(i in models_h3b) {
  names(study2_robust6[[i]]$coefficients) <- c("Constant",
                                       "Source (0 = unknown)",
                                       "Trust",
                                       "Source * Trust")
}

models_h4b <- c("email_h4b", "fb_h4b", "twitter_h4b", "whatsapp_h4b")
for(i in models_h4b) {
  names(study2_robust6[[i]]$coefficients) <- c("Constant",
                                       "Report (0 = left-wing)",
                                       "Attitude",
                                       "Source (0 = unknown)",
                                       "Report * Attitude",
                                       "Report * Source",
                                       "Attitude * Source",
                                       "Report * Attitude * Source")
}

#### Table for all topics ####

full_models_table(study2_robust6, "tab:study2-robust6", 
                  "Sharing tendency for Facebook users only", dep_vars)

```

\elandscape 